import{C}from"./index.97f03277.js";import D from"./detail.bb4f3312.js";import{ah as k,u as v,h as s,r as R,d as A,a as S,o as U,w as L,t as V,c as a,_ as j,a2 as O}from"./index.c5429249.js";import{E as b}from"./EditOutlined.af3970b8.js";import{D as x}from"./DeleteOutlined.e68b06d7.js";import{N as M}from"./Tooltip.d759bd4b.js";import{N as g}from"./Button.c43a24dc.js";import{N as I}from"./Icon.8e3bf5ec.js";import{N as E}from"./Popconfirm.83d41c5f.js";import{N as z}from"./Space.e50db48f.js";import{d as H,a as q}from"./index.847867b6.js";import{p as P}from"./common.145f2eef.js";import{f as T}from"./index.a2051d72.js";import{S as B}from"./SearchOutlined.5b629110.js";import{N as F}from"./Input.97d5419b.js";import{N as $,a as G}from"./DataTable.d85b2298.js";import"./Card.c707a1eb.js";import"./use-rtl.c78ffbd8.js";import"./resolve-slot.7c241306.js";import"./index.16077d24.js";import"./keysOf.963e6f6c.js";import"./lodash.084a01e7.js";import"./service.0215c8a4.js";import"./index.20e11ec3.js";import"./index.3b9f9e63.js";import"./index.3e01cddc.js";import"./flatten.a7868693.js";import"./Scrollbar.12b40993.js";import"./fade-in.cssr.9da325c6.js";import"./VResizeObserver.14b04bb7.js";import"./fade-in-scale-up.cssr.05526022.js";import"./utils.3eee947a.js";import"./is-browser.d3e5def6.js";import"./get-elements-by-json.3336e937.js";import"./Form.13999875.js";import"./FormItem.51e71cc3.js";import"./format-length.e7c2072e.js";import"./Grid.b73d23e7.js";import"./get-slot.c85d6606.js";import"./next-frame-once.da993024.js";import"./Spin.1e9405a1.js";import"./use-compitable.b0459e69.js";import"./Radio.5a2a0c2a.js";import"./RadioGroup.47f9a37a.js";import"./index.31fbc8bd.js";import"./Switch.9ad161ba.js";import"./InputNumber.d8a1dfa4.js";import"./use-locale.be539345.js";import"./Add.e846b00c.js";import"./Select.e833ee40.js";import"./Selection.a106a9c5.js";import"./Popover.df2981b4.js";import"./Suffix.9ee1fead.js";import"./Checkbox.7506e5f5.js";import"./TreeSelect.b9641da1.js";import"./SettingOutlined.716a0298.js";import"./PauseCircleOutlined.813adbbb.js";import"./CloseCircleOutlined.46c86330.js";import"./CheckCircleOutlined.6daee0ce.js";import"./ClockCircleOutlined.6c97131a.js";import"./ArrowDown.db19052e.js";import"./Dropdown.749e9383.js";import"./ChevronRight.f70a9c2d.js";import"./use-keyboard.22724d1e.js";import"./Forward.23552619.js";function J(){return{IS_ADMIN:k().getUserInfo.userType==="ADMIN_USER"}}function K(t){const{t:e}=v();return{getColumns:()=>[{title:"#",key:"index",render:(n,l)=>l+1},{title:e("security.alarm_instance.alarm_instance_name"),key:"instanceName"},{title:e("security.alarm_instance.alarm_plugin_name"),key:"alertPluginName"},{title:e("security.alarm_instance.create_time"),key:"createTime"},{title:e("security.alarm_instance.update_time"),key:"updateTime"},{title:e("security.alarm_instance.operation"),key:"operation",width:150,render:n=>s(z,null,{default:()=>[s(M,null,{trigger:()=>s(g,{circle:!0,type:"info",size:"small",onClick:()=>void t(n,"edit")},{default:()=>s(I,null,{default:()=>s(b)})}),default:()=>e("security.alarm_instance.edit")}),s(M,null,{trigger:()=>s(E,{onPositiveClick:()=>void t(n,"delete"),negativeText:e("security.alarm_instance.cancel"),positiveText:e("security.alarm_instance.confirm")},{trigger:()=>s(g,{circle:!0,type:"error",size:"small"},{default:()=>s(I,null,{default:()=>s(x)})}),default:()=>e("security.alarm_instance.delete_confirm")}),default:()=>e("security.alarm_instance.delete")})]})}]}}function Q(){const t=R({page:1,pageSize:10,itemCount:0,searchVal:"",list:[],loading:!1}),e=async()=>{if(t.loading)return;t.loading=!0;const{totalList:i,total:m}=await q({pageNo:t.page,pageSize:t.pageSize,searchVal:t.searchVal});if(t.loading=!1,!i)throw Error();t.list=i.map(o=>(o.createTime=o.createTime?T(P(o.createTime),"yyyy-MM-dd HH:mm:ss"):"",o.updateTime=o.updateTime?T(P(o.updateTime),"yyyy-MM-dd HH:mm:ss"):"",o)),t.itemCount=m},r=()=>{t.list.length===1&&t.page>1&&--t.page,e()};return{data:t,changePage:i=>{t.page=i,e()},changePageSize:i=>{t.page=1,t.pageSize=i,e()},deleteRecord:async i=>{await H(i),r()},updateList:r}}const W="_conditions_dre2i_17",X="_pagination_dre2i_27";var p={conditions:W,"conditions-search-input":"_conditions-search-input_dre2i_23",pagination:X,"mt-8":"_mt-8_dre2i_32"};function Y(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!j(t)}const ce=A({name:"alarm-instance-manage",setup(){const{t}=v(),e=S(!1),r=S(),n=S(),{IS_ADMIN:l}=J(),{data:u,changePage:i,changePageSize:m,deleteRecord:o,updateList:f}=Q(),{getColumns:d}=K((c,h)=>{h==="edit"?(e.value=!0,r.value=c):o(c.id)}),_=()=>{r.value=null,e.value=!0},y=()=>{e.value=!1,r.value={}};return U(()=>{i(1),n.value=d()}),L(v().locale,()=>{n.value=d()}),{t,IS_ADMIN:l,showDetailModal:e,currentRecord:r,columns:n,...V(u),changePage:i,changePageSize:m,onCreate:_,onCloseModal:y,onUpdatedList:f}},render(){const{t,IS_ADMIN:e,currentRecord:r,showDetailModal:n,columns:l,list:u,page:i,pageSize:m,itemCount:o,loading:f,changePage:d,changePageSize:_,onCreate:y,onUpdatedList:c,onCloseModal:h}=this;return a(O,null,[a(C,{title:""},{default:()=>{let N;return a("div",{class:p.conditions},[e&&a(g,{onClick:y,type:"primary"},Y(N=t("security.alarm_instance.create_alarm_instance"))?N:{default:()=>[N]}),a(z,{class:p["conditions-search"],justify:"end",wrap:!1},{default:()=>[a("div",{class:p["conditions-search-input"]},[a(F,{value:this.searchVal,"onUpdate:value":w=>this.searchVal=w,placeholder:`${t("security.alarm_instance.search_input_tips")}`},null)]),a(g,{type:"primary",onClick:c},{default:()=>[a(I,null,{default:()=>[a(B,null,null)]})]})]})])}}),a(C,{title:"",class:p["mt-8"]},{default:()=>[a($,{columns:l,data:u,loading:f,striped:!0},null),a(G,{page:i,"page-size":m,"item-count":o,"show-quick-jumper":!0,class:p.pagination,"on-update:page":d,"on-update:page-size":_},null)]}),e&&a(D,{show:n,currentRecord:r,onCancel:h,onUpdate:c},null)])}});export{ce as default};

import{d as O,bB as V,bz as H,bA as T,a as W,u as B,o as z,w as q,t as N,c as t,h as S,_ as J}from"./index.c5429249.js";import{M as K}from"./index.20e11ec3.js";import{u as Q,a as X}from"./use-modal.4eacfaef.js";import{s as j}from"./index.module.e21b9b67.js";import{A as g,a as E}from"./ArrowUpOutlined.a96a5df0.js";import{D as Y}from"./DeleteOutlined.e68b06d7.js";import{N as v}from"./Icon.8e3bf5ec.js";import{N as Z}from"./Form.13999875.js";import{N as a}from"./FormItem.51e71cc3.js";import{N as y}from"./RadioGroup.47f9a37a.js";import{N as c}from"./Space.e50db48f.js";import{N as f}from"./Radio.5a2a0c2a.js";import{a as k}from"./Select.e833ee40.js";import{a as P}from"./Checkbox.7506e5f5.js";import{N as M}from"./Input.97d5419b.js";import{N as $}from"./DatePicker.fbb7ccb7.js";import{N as L}from"./Button.c43a24dc.js";import{N as tt}from"./Switch.9ad161ba.js";import"./index.3b9f9e63.js";import"./keysOf.963e6f6c.js";import"./Card.c707a1eb.js";import"./use-rtl.c78ffbd8.js";import"./resolve-slot.7c241306.js";import"./index.16077d24.js";import"./index.3e01cddc.js";import"./flatten.a7868693.js";import"./Scrollbar.12b40993.js";import"./fade-in.cssr.9da325c6.js";import"./VResizeObserver.14b04bb7.js";import"./fade-in-scale-up.cssr.05526022.js";import"./utils.3eee947a.js";import"./is-browser.d3e5def6.js";import"./lodash.084a01e7.js";import"./index.cc06751b.js";import"./service.0215c8a4.js";import"./index.fd50cc71.js";import"./index.8ea7b56a.js";import"./index.c537589f.js";import"./index.5926f13f.js";import"./common.145f2eef.js";import"./SettingOutlined.716a0298.js";import"./PauseCircleOutlined.813adbbb.js";import"./CloseCircleOutlined.46c86330.js";import"./CheckCircleOutlined.6daee0ce.js";import"./EditOutlined.af3970b8.js";import"./ClockCircleOutlined.6c97131a.js";import"./index.a2051d72.js";import"./format-length.e7c2072e.js";import"./get-slot.c85d6606.js";import"./use-locale.be539345.js";import"./use-compitable.b0459e69.js";import"./Selection.a106a9c5.js";import"./Popover.df2981b4.js";import"./next-frame-once.da993024.js";import"./Suffix.9ee1fead.js";import"./use-keyboard.22724d1e.js";import"./Forward.23552619.js";const et={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},rt=T("path",{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z",fill:"currentColor"},null,-1),ot=T("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448s448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z",fill:"currentColor"},null,-1),at=[rt,ot];var C=O({name:"PlusCircleOutlined",render:function(m,d){return V(),H("svg",et,at)}});function i(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!J(o)}const lt={row:{type:Object,default:{}},show:{type:Boolean,default:!1},taskCode:{type:String}};var pe=O({name:"workflowDefinitionStart",props:lt,emits:["update:show","update:row","updateList"],setup(o,m){const d=W(!1),{t:l}=B(),{startState:n}=Q(),{variables:s,handleStartDefinition:h,getWorkerGroups:w,getAlertGroups:_,getEnvironmentList:r,getStartParamsList:e}=X(n,m),p=()=>{m.emit("update:show")},b=()=>{h(o.row.code)},U=()=>[{value:"NONE",label:l("project.workflow.none_send")},{value:"SUCCESS",label:l("project.workflow.success_send")},{value:"FAILURE",label:l("project.workflow.failure_send")},{value:"ALL",label:l("project.workflow.all_send")}],R=()=>[{value:"HIGHEST",label:"HIGHEST",color:"#ff0000",icon:g},{value:"HIGH",label:"HIGH",color:"#ff0000",icon:g},{value:"MEDIUM",label:"MEDIUM",color:"#EA7D24",icon:g},{value:"LOW",label:"LOW",color:"#2A8734",icon:E},{value:"LOWEST",label:"LOWEST",color:"#2A8734",icon:E}],A=u=>[S(v,{style:{verticalAlign:"middle",marginRight:"4px",marginBottom:"3px"},color:u.color},{default:()=>S(u.icon)}),u.label],D=()=>{n.startForm.environmentCode=null},I=()=>{s.startParamsList.push({prop:"",value:""})},x=(u,F)=>{s.startParamsList[u].prop=F[0],s.startParamsList[u].value=F[1]},G=u=>{s.startParamsList.splice(u,1)};return z(()=>{w(),_(),r()}),q(()=>o.show,()=>{o.show&&(e(o.row.code),o.taskCode&&(n.startForm.startNodeList=o.taskCode))}),{t:l,parallelismRef:d,hideModal:p,handleStart:b,generalWarningTypeListOptions:U,generalPriorityList:R,renderLabel:A,updateWorkerGroup:D,removeStartParams:G,addStartParams:I,updateParamsList:x,...N(s),...N(n),...N(o)}},render(){let o,m,d,l,n,s,h,w,_;const{t:r}=this;return t(K,{show:this.show,title:r("project.workflow.set_parameters_before_starting"),onCancel:this.hideModal,onConfirm:this.handleStart,confirmLoading:this.saving},{default:()=>[t(Z,{ref:"startFormRef"},{default:()=>[t(a,{label:r("project.workflow.workflow_name"),path:"workflow_name"},{default:()=>[t("div",{class:j.formItem,title:this.row.name},[this.row.name])]}),t(a,{label:r("project.workflow.failure_strategy"),path:"failureStrategy"},{default:()=>[t(y,{value:this.startForm.failureStrategy,"onUpdate:value":e=>this.startForm.failureStrategy=e},{default:()=>[t(c,null,{default:()=>[t(f,{value:"CONTINUE"},i(o=r("project.workflow.continue"))?o:{default:()=>[o]}),t(f,{value:"END"},i(m=r("project.workflow.end"))?m:{default:()=>[m]})]})]})]}),t(a,{label:r("project.workflow.notification_strategy"),path:"warningType"},{default:()=>[t(k,{options:this.generalWarningTypeListOptions(),value:this.startForm.warningType,"onUpdate:value":e=>this.startForm.warningType=e},null)]}),t(a,{label:r("project.workflow.workflow_priority"),path:"processInstancePriority"},{default:()=>[t(k,{options:this.generalPriorityList(),renderLabel:this.renderLabel,value:this.startForm.processInstancePriority,"onUpdate:value":e=>this.startForm.processInstancePriority=e},null)]}),t(a,{label:r("project.workflow.worker_group"),path:"workerGroup"},{default:()=>[t(k,{options:this.workerGroups,onUpdateValue:this.updateWorkerGroup,value:this.startForm.workerGroup,"onUpdate:value":e=>this.startForm.workerGroup=e},null)]}),t(a,{label:r("project.workflow.environment_name"),path:"environmentCode"},{default:()=>[t(k,{options:this.environmentList.filter(e=>{var p;return(p=e.workerGroups)==null?void 0:p.includes(this.startForm.workerGroup)}),value:this.startForm.environmentCode,"onUpdate:value":e=>this.startForm.environmentCode=e,clearable:!0},null)]}),t(a,{label:r("project.workflow.alarm_group"),path:"warningGroupId"},{default:()=>[t(k,{options:this.alertGroups,placeholder:r("project.workflow.please_choose"),value:this.startForm.warningGroupId,"onUpdate:value":e=>this.startForm.warningGroupId=e,clearable:!0},null)]}),t(a,{label:r("project.workflow.complement_data"),path:"complement_data"},{default:()=>[t(P,{checkedValue:"COMPLEMENT_DATA",uncheckedValue:"START_PROCESS",checked:this.startForm.execType,"onUpdate:checked":e=>this.startForm.execType=e},i(d=r("project.workflow.whether_complement_data"))?d:{default:()=>[d]})]}),this.startForm.execType&&this.startForm.execType!=="START_PROCESS"&&t(c,null,{default:()=>[t(a,{label:r("project.workflow.mode_of_dependent"),path:"complementDependentMode"},{default:()=>[t(y,{value:this.startForm.complementDependentMode,"onUpdate:value":e=>this.startForm.complementDependentMode=e},{default:()=>[t(c,null,{default:()=>[t(f,{value:"OFF_MODE"},i(l=r("project.workflow.close"))?l:{default:()=>[l]}),t(f,{value:"ALL_DEPENDENT"},i(n=r("project.workflow.open"))?n:{default:()=>[n]})]})]})]}),t(a,{label:r("project.workflow.mode_of_execution"),path:"runMode"},{default:()=>[t(y,{value:this.startForm.runMode,"onUpdate:value":e=>this.startForm.runMode=e},{default:()=>[t(c,null,{default:()=>[t(f,{value:"RUN_MODE_SERIAL"},i(s=r("project.workflow.serial_execution"))?s:{default:()=>[s]}),t(f,{value:"RUN_MODE_PARALLEL"},i(h=r("project.workflow.parallel_execution"))?h:{default:()=>[h]})]})]})]}),this.startForm.runMode==="RUN_MODE_PARALLEL"&&t(a,{label:r("project.workflow.parallelism"),path:"expectedParallelismNumber"},{default:()=>[t(P,{checked:this.parallelismRef,"onUpdate:checked":e=>this.parallelismRef=e},i(w=r("project.workflow.custom_parallelism"))?w:{default:()=>[w]}),t(M,{disabled:!this.parallelismRef,placeholder:r("project.workflow.please_enter_parallelism"),value:this.startForm.expectedParallelismNumber,"onUpdate:value":e=>this.startForm.expectedParallelismNumber=e},null)]}),t(a,{label:r("project.workflow.schedule_date"),path:"startEndTime"},{default:()=>[t($,{type:"datetimerange",clearable:!0,value:this.startForm.startEndTime,"onUpdate:value":e=>this.startForm.startEndTime=e,placement:"top"},null)]})]}),t(a,{label:r("project.workflow.startup_parameter"),path:"startup_parameter"},{default:()=>[this.startParamsList.length===0?t(L,{text:!0,type:"primary",onClick:this.addStartParams},{default:()=>[t(v,null,{default:()=>[t(C,null,null)]})]}):t(c,{vertical:!0},i(_=this.startParamsList.map((e,p)=>t(c,{class:j.startup,key:Date.now()+p},{default:()=>[t(M,{pair:!0,separator:":",placeholder:["prop","value"],defaultValue:[e.prop,e.value],onUpdateValue:b=>this.updateParamsList(p,b)},null),t(L,{text:!0,type:"error",onClick:()=>this.removeStartParams(p),class:"btn-delete-custom-parameter"},{default:()=>[t(v,null,{default:()=>[t(Y,null,null)]})]}),t(L,{text:!0,type:"primary",onClick:this.addStartParams,class:"btn-create-custom-parameter"},{default:()=>[t(v,null,{default:()=>[t(C,null,null)]})]})]})))?_:{default:()=>[_]})]}),t(a,{label:r("project.workflow.whether_dry_run"),path:"dryRun"},{default:()=>[t(tt,{checkedValue:1,uncheckedValue:0,value:this.startForm.dryRun,"onUpdate:value":e=>this.startForm.dryRun=e},null)]})]})]})}});export{pe as default};

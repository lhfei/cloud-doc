import{bH as b,u as y,r as v,a as u,d as T,o as w,w as C,t as R,c as i}from"./index.c5429249.js";import{u as L}from"./index.075b615e.js";import{l}from"./lodash.084a01e7.js";import{c as M,a as H}from"./index.4fa174fc.js";import{f}from"./index.a2051d72.js";import S from"./state-card.876147da.js";import P from"./definition-card.220836b2.js";import{g as x}from"./DatePicker.fbb7ccb7.js";import{s as V}from"./index.a283cad2.js";import{N as D,a as h}from"./Grid.b73d23e7.js";import"./service.0215c8a4.js";import"./Pie.2aaa2512.js";import"./index.0a49dc37.js";import"./index.97f03277.js";import"./Card.c707a1eb.js";import"./use-rtl.c78ffbd8.js";import"./resolve-slot.7c241306.js";import"./index.16077d24.js";import"./keysOf.963e6f6c.js";import"./DataTable.d85b2298.js";import"./ArrowDown.db19052e.js";import"./format-length.e7c2072e.js";import"./Button.c43a24dc.js";import"./is-browser.d3e5def6.js";import"./Scrollbar.12b40993.js";import"./fade-in.cssr.9da325c6.js";import"./VResizeObserver.14b04bb7.js";import"./Checkbox.7506e5f5.js";import"./RadioGroup.47f9a37a.js";import"./flatten.a7868693.js";import"./get-slot.c85d6606.js";import"./Radio.5a2a0c2a.js";import"./Popover.df2981b4.js";import"./index.3e01cddc.js";import"./utils.3eee947a.js";import"./use-compitable.b0459e69.js";import"./next-frame-once.da993024.js";import"./Dropdown.749e9383.js";import"./Tooltip.d759bd4b.js";import"./Icon.8e3bf5ec.js";import"./ChevronRight.f70a9c2d.js";import"./Selection.a106a9c5.js";import"./use-locale.be539345.js";import"./Suffix.9ee1fead.js";import"./fade-in-scale-up.cssr.05526022.js";import"./use-keyboard.22724d1e.js";import"./Input.97d5419b.js";import"./Select.e833ee40.js";import"./Forward.23552619.js";import"./Bar.e20384f3.js";function _(){const n=b(),{t:r}=y(),e=v({taskLoadingRef:u(!1)});return{getTaskState:t=>{if(e.taskLoadingRef)return;e.taskLoadingRef=!0;const{state:p}=L(M({startDate:t?f(t[0],"yyyy-MM-dd HH:mm:ss"):"",endDate:t?f(t[1],"yyyy-MM-dd HH:mm:ss"):"",projectCode:Number(n.params.projectCode)}).then(a=>{const s=a.taskCountDtos.map((o,d)=>({state:r("home."+l.exports.toLower(o.taskStateType)),number:o.count})),c=a.taskCountDtos.map(o=>({value:o.count,name:r("home."+l.exports.toLower(o.taskStateType))}));return e.taskLoadingRef=!1,{table:s,chart:c}}),{table:[],chart:[]});return p},taskVariables:e}}function N(){const n=b(),{t:r}=y(),e=v({processLoadingRef:u(!1)});return{getProcessState:t=>{if(e.processLoadingRef)return;e.processLoadingRef=!0;const{state:p}=L(H({startDate:t?f(t[0],"yyyy-MM-dd HH:mm:ss"):"",endDate:t?f(t[1],"yyyy-MM-dd HH:mm:ss"):"",projectCode:Number(n.params.projectCode)}).then(a=>{const s=a.taskCountDtos.map((o,d)=>({state:r("home."+l.exports.toLower(o.taskStateType)),number:o.count})),c=a.taskCountDtos.map(o=>({value:o.count,name:r("home."+l.exports.toLower(o.taskStateType))}));return e.processLoadingRef=!1,{table:s,chart:c}}),{table:[],chart:[]});return p},processVariables:e}}const xt=T({name:"workflow-monitor",setup(){const{t:n,locale:r}=y(),e=u([x(V()),Date.now()]),m=u(),t=u(),{getTaskState:p,taskVariables:a}=_(),{getProcessState:s,processVariables:c}=N(),o=k=>{m.value=p(k)},d=k=>{t.value=s(k)},g=()=>{m.value=p(e.value)||m.value,t.value=s(e.value)||t.value};return w(()=>{g()}),C(()=>r.value,()=>g()),{t:n,dateRef:e,handleTaskDate:o,handleProcessDate:d,taskStateRef:m,processStateRef:t,...R(a),...R(c)}},render(){const{t:n,dateRef:r,handleTaskDate:e,handleProcessDate:m,taskLoadingRef:t,processLoadingRef:p}=this;return i("div",null,[i(D,{"x-gap":12,cols:2},{default:()=>[i(h,null,{default:()=>{var a,s;return[i(S,{title:n("home.task_state_statistics"),date:r,tableData:(a=this.taskStateRef)==null?void 0:a.value.table,chartData:(s=this.taskStateRef)==null?void 0:s.value.chart,onUpdateDatePickerValue:e,loadingRef:t},null)]}}),i(h,null,{default:()=>{var a,s;return[i(S,{title:n("home.process_state_statistics"),date:r,tableData:(a=this.processStateRef)==null?void 0:a.value.table,chartData:(s=this.processStateRef)==null?void 0:s.value.chart,onUpdateDatePickerValue:m,loadingRef:p},null)]}})]}),i(D,{cols:1,style:"margin-top: 12px;"},{default:()=>[i(h,null,{default:()=>[i(P,{title:n("home.process_definition_statistics")},null)]})]})])}});export{xt as default};

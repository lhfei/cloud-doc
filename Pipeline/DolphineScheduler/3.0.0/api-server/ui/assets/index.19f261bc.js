import{d as k,bB as h,bz as g,bA as C,r as _,a as m,u as N,o as b,w as j,t as y,c as t,bH as W}from"./index.c5429249.js";import{u as w}from"./index.075b615e.js";import{s as u}from"./service.0215c8a4.js";import{C as v}from"./index.97f03277.js";import F from"./Graph.62dc4aee.js";import{R as D}from"./index.bef6705c.js";import{R}from"./ReloadOutlined.3fddf0fb.js";import{N as S}from"./Space.e50db48f.js";import{a as O}from"./Select.e833ee40.js";import{N as p}from"./Tooltip.d759bd4b.js";import{N as f}from"./Button.c43a24dc.js";import{N as d}from"./Icon.8e3bf5ec.js";import"./lodash.084a01e7.js";import"./Card.c707a1eb.js";import"./use-rtl.c78ffbd8.js";import"./resolve-slot.7c241306.js";import"./index.16077d24.js";import"./keysOf.963e6f6c.js";import"./index.0a49dc37.js";import"./is-browser.d3e5def6.js";import"./flatten.a7868693.js";import"./get-slot.c85d6606.js";import"./fade-in-scale-up.cssr.05526022.js";import"./Scrollbar.12b40993.js";import"./fade-in.cssr.9da325c6.js";import"./VResizeObserver.14b04bb7.js";import"./use-locale.be539345.js";import"./use-compitable.b0459e69.js";import"./Selection.a106a9c5.js";import"./Popover.df2981b4.js";import"./index.3e01cddc.js";import"./format-length.e7c2072e.js";import"./utils.3eee947a.js";import"./next-frame-once.da993024.js";import"./Suffix.9ee1fead.js";const x={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},B=C("path",{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 0 0 0 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3c7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176s176-78.8 176-176s-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112s112 50.1 112 112s-50.1 112-112 112z",fill:"currentColor"},null,-1),L=[B];var z=k({name:"EyeOutlined",render:function(l,s){return h(),g("svg",x,L)}});function q(o){return u({url:`/projects/${o.projectCode}/lineages/list`,method:"get"})}function $(o){return u({url:`/projects/${o.projectCode}/lineages/query-by-name`,method:"get"})}function E(o,l){return u({url:`/projects/${l.projectCode}/lineages/${o.workFlowCode}`,method:"get"})}function M(){const o=_({workflowOptions:[],workflow:m(null),seriesData:[],labelShow:m(!0),links:[]}),l=r=>{o.seriesData=[],o.links=[],o.seriesData=r.workFlowList.map(e=>({name:e.workFlowName,id:e.workFlowCode,...e})),o.links=r.workFlowRelationList.map(e=>({source:String(e.sourceWorkFlowCode),target:String(e.targetWorkFlowCode)}))};return{variables:o,getWorkflowName:r=>{const{state:e}=w($({projectCode:r}).then(n=>{o.workflowOptions=n.map(i=>({label:i.workFlowName,value:i.workFlowCode}))}),{});return e},getOneWorkflow:(r,e)=>{const{state:n}=w(E({workFlowCode:r},{projectCode:e}).then(i=>{l(i)}),{});return n},getWorkflowList:r=>{const{state:e}=w(q({projectCode:r}).then(n=>{l(n)}),{});return e}}}const bo=k({name:"workflow-relation",setup(){const{t:o,locale:l}=N(),s=W(),{variables:a,getWorkflowName:c,getOneWorkflow:r,getWorkflowList:e}=M();b(()=>{e(Number(s.params.projectCode)),c(Number(s.params.projectCode))});const n=()=>{a.seriesData=[],a.workflow&&a.workflow!==0?r(Number(a.workflow),Number(s.params.projectCode)):e(Number(s.params.projectCode))};return j(()=>[a.workflow,a.labelShow,l.value],()=>{n()}),{t:o,handleResetDate:n,...y(a)}},render(){const{t:o,handleResetDate:l}=this;return this.seriesData.length===0&&t(D,{title:o("project.workflow.workflow_relation_no_data_result_title"),description:o("project.workflow.workflow_relation_no_data_result_desc"),status:"info",size:"medium"},null)||this.seriesData.length>0&&t(v,{title:o("project.workflow.workflow_relation")},{default:()=>Object.keys(this.seriesData).length>0&&t(F,{seriesData:this.seriesData,labelShow:this.labelShow,links:this.links},null),"header-extra":()=>t(S,null,{default:()=>[t(O,{clearable:!0,style:{width:"300px"},placeholder:o("project.workflow.workflow_name"),options:this.workflowOptions,value:this.workflow,"onUpdate:value":s=>this.workflow=s},null),t(p,{trigger:"hover"},{default:()=>o("project.workflow.refresh"),trigger:()=>t(f,{strong:!0,secondary:!0,circle:!0,type:"info",onClick:l},{default:()=>[t(d,null,{default:()=>[t(R,null,null)]})]})}),t(p,{trigger:"hover"},{default:()=>o("project.workflow.show_hide_label"),trigger:()=>t(f,{strong:!0,secondary:!0,circle:!0,type:"info",onClick:()=>this.labelShow=!this.labelShow},{default:()=>[t(d,null,{default:()=>[t(z,null,null)]})]})})]})})}});export{bo as default};

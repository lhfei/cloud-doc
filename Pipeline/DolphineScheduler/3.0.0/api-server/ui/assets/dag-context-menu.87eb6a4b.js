import{g as w}from"./index.bdf8fa15.js";import{d as I,n as T,a as $,o as L,u as x,c as o,_ as B,bH as O}from"./index.c5429249.js";import{u as V}from"./common.145f2eef.js";import{N as m}from"./Button.c43a24dc.js";import"./service.0215c8a4.js";import"./lodash.084a01e7.js";import"./SettingOutlined.716a0298.js";import"./PauseCircleOutlined.813adbbb.js";import"./CloseCircleOutlined.46c86330.js";import"./CheckCircleOutlined.6daee0ce.js";import"./EditOutlined.af3970b8.js";import"./ClockCircleOutlined.6c97131a.js";import"./index.a2051d72.js";import"./is-browser.d3e5def6.js";import"./use-rtl.c78ffbd8.js";import"./resolve-slot.7c241306.js";var s={"dag-context-menu":"_dag-context-menu_e40aw_17","menu-item":"_menu-item_e40aw_25"};function c(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!B(e)}const E={startReadonly:{type:Boolean,default:!1},menuReadonly:{type:Boolean,default:!1},taskInstance:{type:Object,require:!0},cell:{type:Object,require:!0},visible:{type:Boolean,default:!0},left:{type:Number,default:0},top:{type:Number,default:0}};var Y=I({name:"dag-context-menu",props:E,emits:["hide","start","edit","viewLog","copyTask","removeTasks"],setup(e,t){const i=T("graph",$()),l=O(),d=Number(l.params.projectCode),n=()=>{t.emit("hide",!1)},y=()=>{var a;t.emit("start",Number((a=e.cell)==null?void 0:a.id))},g=()=>{var a;t.emit("edit",Number((a=e.cell)==null?void 0:a.id))},k=()=>{e.taskInstance&&t.emit("viewLog",e.taskInstance.id,e.taskInstance.taskType)},b=()=>{var u,p,f,h;const r=(u=e.cell)==null?void 0:u.data.taskType,N=V(((p=e.cell)==null?void 0:p.data.taskName)+"_"),C=Number((f=e.cell)==null?void 0:f.id),j=(h=e.cell)==null?void 0:h.data.flag;w(1,d).then(v=>{const[R]=v;t.emit("copyTask",N,R,C,r,j,{x:e.left+100,y:e.top+100})})},_=()=>{var a,r;(a=i.value)==null||a.removeCell(e.cell),t.emit("removeTasks",[Number((r=e.cell)==null?void 0:r.id)])};return L(()=>{document.addEventListener("click",()=>{n()})}),{startRunning:y,handleEdit:g,handleCopy:b,handleDelete:_,handleViewLog:k}},render(){let e,t,i,l,d;const{t:n}=x();return this.visible&&o("div",{class:s["dag-context-menu"],style:{left:`${this.left}px`,top:`${this.top}px`}},[o(m,{class:`${s["menu-item"]}`,disabled:this.startReadonly,onClick:this.startRunning},c(e=n("project.node.start"))?e:{default:()=>[e]}),o(m,{class:`${s["menu-item"]}`,disabled:this.menuReadonly,onClick:this.handleEdit},c(t=n("project.node.edit"))?t:{default:()=>[t]}),o(m,{class:`${s["menu-item"]}`,disabled:this.menuReadonly,onClick:this.handleCopy},c(i=n("project.node.copy"))?i:{default:()=>[i]}),o(m,{class:`${s["menu-item"]}`,disabled:this.menuReadonly,onClick:this.handleDelete},c(l=n("project.node.delete"))?l:{default:()=>[l]}),this.taskInstance&&o(m,{class:`${s["menu-item"]}`,onClick:this.handleViewLog},c(d=n("project.node.view_log"))?d:{default:()=>[d]})])}});export{Y as default};

import{g as Ee,F as ke}from"./get-elements-by-json.3336e937.js";import{u as v,bR as we,h as V,a as c,o as G,w as Y,j as S,H as le,J as re,br as ue,bl as ce,r as k,X as te,d as Le,c as Ne,n as Ce}from"./index.c5429249.js";import{A as Z,a as ne}from"./ArrowUpOutlined.a96a5df0.js";import{N as de}from"./Icon.8e3bf5ec.js";import{q as Pe}from"./index.fd50cc71.js";import{a as qe}from"./index.8ea7b56a.js";import{q as Re}from"./index.bbd47aff.js";import{u as U}from"./task-node.0b2752c6.js";import{T as Ie}from"./task-type.1f698d1a.js";import{q as me,a as ae,b as Oe,g as xe}from"./index.cc06751b.js";import"./service.0215c8a4.js";import{l as K}from"./lodash.084a01e7.js";import{k as De,l as Me,m as Ae}from"./index.8259a597.js";import{h as z,i as se,j as ie}from"./index.3b5bce66.js";import{l as He}from"./index.c537589f.js";import{e as Fe}from"./index.bbb6cfa3.js";import{t as Ye}from"./common.145f2eef.js";import{g as Ge,b as ee,c as Qe}from"./index.650fd948.js";import"./Form.13999875.js";import"./FormItem.51e71cc3.js";import"./Button.c43a24dc.js";import"./is-browser.d3e5def6.js";import"./use-rtl.c78ffbd8.js";import"./resolve-slot.7c241306.js";import"./format-length.e7c2072e.js";import"./fade-in.cssr.9da325c6.js";import"./keysOf.963e6f6c.js";import"./Grid.b73d23e7.js";import"./index.16077d24.js";import"./utils.3eee947a.js";import"./VResizeObserver.14b04bb7.js";import"./flatten.a7868693.js";import"./get-slot.c85d6606.js";import"./next-frame-once.da993024.js";import"./Spin.1e9405a1.js";import"./use-compitable.b0459e69.js";import"./Input.97d5419b.js";import"./use-locale.be539345.js";import"./Scrollbar.12b40993.js";import"./Suffix.9ee1fead.js";import"./Radio.5a2a0c2a.js";import"./RadioGroup.47f9a37a.js";import"./Space.e50db48f.js";import"./index.31fbc8bd.js";import"./DeleteOutlined.e68b06d7.js";import"./index.3e01cddc.js";import"./Switch.9ad161ba.js";import"./InputNumber.d8a1dfa4.js";import"./Add.e846b00c.js";import"./Select.e833ee40.js";import"./fade-in-scale-up.cssr.05526022.js";import"./Selection.a106a9c5.js";import"./Popover.df2981b4.js";import"./Checkbox.7506e5f5.js";import"./TreeSelect.b9641da1.js";import"./SettingOutlined.716a0298.js";import"./PauseCircleOutlined.813adbbb.js";import"./CloseCircleOutlined.46c86330.js";import"./CheckCircleOutlined.6daee0ce.js";import"./EditOutlined.af3970b8.js";import"./ClockCircleOutlined.6c97131a.js";import"./index.a2051d72.js";function w(t){const{t:e}=v();return{type:"input",field:"name",class:"input-node-name",name:e(t===1?"project.node.task_name":"project.node.name"),props:{placeholder:e("project.node.name_tips"),maxLength:100},validate:{trigger:["input","blur"],required:!0,message:e("project.node.name_tips")}}}function L(){const{t}=v(),e=[{label:t("project.node.normal"),value:"YES"},{label:t("project.node.prohibition_execution"),value:"NO"}];return{type:"radio",field:"flag",name:t("project.node.run_flag"),options:e}}function N(){const{t}=v();return{type:"input",field:"description",name:t("project.node.description"),props:{placeholder:t("project.node.description_tips"),rows:2,type:"textarea"}}}function C(){const{t}=v(),e=we([{label:"HIGHEST",value:"HIGHEST",icon:Z,color:"#ff0000"},{label:"HIGH",value:"HIGH",icon:Z,color:"#ff0000"},{label:"MEDIUM",value:"MEDIUM",icon:Z,color:"#EA7D24"},{label:"LOW",value:"LOW",icon:ne,color:"#2A8734"},{label:"LOWEST",value:"LOWEST",icon:ne,color:"#2A8734"}]),o=({node:r,option:a})=>V(r,null,{default:()=>[V(de,{color:a.color},{default:()=>V(a.icon)}),a.label]});return{type:"select",field:"taskPriority",name:t("project.node.task_priority"),options:e,validate:{required:!0},props:{renderOption:o},value:"MEDIUM"}}function P(){const{t}=v(),e=c([]),o=c(!1),r=async()=>{if(o.value)return;o.value=!0;const a=await Pe();e.value=a.map(n=>({label:n,value:n})),o.value=!1};return G(()=>{r()}),{type:"select",field:"workerGroup",span:12,name:t("project.node.worker_group"),props:{loading:o},options:e,validate:{trigger:["input","blur"],required:!0,message:t("project.node.worker_group_tips")},value:"default"}}function q(t,e){const{t:o}=v();let r=[];const a=c([]),n=c(!1);let s=!1;const i=async()=>{if(n.value)return;n.value=!0,r=(await qe()).map(p=>({label:p.name,value:p.code,workerGroups:p.workerGroups})),a.value=r.filter(p=>m(p)),n.value=!1,a.value.length===0?t.environmentCode=null:e&&(t.environmentCode=a.value[0].value)},m=l=>{var p;return!t.workerGroup||!((p=l==null?void 0:l.workerGroups)!=null&&p.length)?!1:l.workerGroups.indexOf(t.workerGroup)!==-1};return Y(()=>t.workerGroup,()=>{!t.workerGroup||!s||(a.value=r.filter(l=>m(l)),t.environmentCode=a.value.length===0?null:a.value[0].value)}),G(async()=>{await i(),s=!0}),{type:"select",field:"environmentCode",span:12,name:o("project.node.environment_name"),props:{loading:n,clearable:!0},options:a}}function R(t,e){const{t:o}=v(),r=c([]),a=c(!1),n=S(()=>!t.taskGroupId),s=async()=>{if(a.value)return;a.value=!0;const{totalList:i=[]}=await Re({pageNo:1,pageSize:2147483647,projectCode:e});r.value=i.map(m=>({label:m.name,value:m.id})),a.value=!1};return G(()=>{s()}),Y(()=>t.taskGroupId,i=>{i||(t.taskGroupId=null,t.taskGroupPriority=null)}),[{type:"select",field:"taskGroupId",span:12,name:o("project.node.task_group_name"),props:{loading:a,clearable:!0},options:r},{type:"input-number",field:"taskGroupPriority",name:o("project.node.task_group_queue_priority"),props:{max:Math.pow(10,60)-1,disabled:n},span:12}]}function D(){const{t}=v();return[{type:"input-number",field:"failRetryTimes",name:t("project.node.number_of_failed_retries"),span:12,props:{min:0},slots:{suffix:()=>t("project.node.times")}},{type:"input-number",field:"failRetryInterval",name:t("project.node.failed_retry_interval"),span:12,props:{min:0},slots:{suffix:()=>t("project.node.minute")}}]}function H(t){const{t:e}=v();return{type:"input-number",field:"delayTime",name:e("project.node.delay_execution_time"),span:12,props:{min:0},slots:{suffix:()=>e("project.node.minute")},value:t.delayTime||0}}function M(t){const{t:e}=v(),o=S(()=>t.timeoutFlag?12:0),r=[{label:e("project.node.timeout_alarm"),value:"WARN"},{label:e("project.node.timeout_failure"),value:"FAILED"}];return[{type:"switch",field:"timeoutFlag",name:e("project.node.timeout_alarm"),props:{"on-update:value":a=>{a&&(t.timeoutNotifyStrategy.length||(t.timeoutNotifyStrategy=["WARN"]),t.timeout||(t.timeout=30))}}},{type:"checkbox",field:"timeoutNotifyStrategy",name:e("project.node.timeout_strategy"),options:r,span:o,validate:{trigger:["input"],validator(a,n){if(t.timeoutFlag&&!n.length)return new Error(e("project.node.timeout_strategy_tips"))}}},{type:"input-number",field:"timeout",name:e("project.node.timeout_period"),span:o,props:{max:Math.pow(10,10)-1},slots:{suffix:()=>e("project.node.minute")},validate:{trigger:["input"],validator(a,n){if(t.timeoutFlag&&!/^[1-9]\d*$/.test(String(n)))return new Error(e("project.node.timeout_period_tips"))}}}]}function I(){const{t}=v(),e=U();return{type:"select",field:"preTasks",span:24,class:"pre-tasks-model",name:t("project.node.pre_tasks"),props:{multiple:!0,filterable:!0},options:e.getPreTaskOptions}}function O(t,e){const{t:o}=v(),r=["CONDITIONS","SWITCH"],a=Object.keys(Ie).map(n=>({label:n,value:n,disabled:r.includes(n)}));return{type:"select",field:"taskType",span:24,name:o("project.node.task_type"),props:{disabled:e||["CONDITIONS","SWITCH"].includes(t.taskType)},options:a,validate:{trigger:["input","blur"],required:!0,message:o("project.node.task_type_tips")},value:t.taskType?t.taskType:"SHELL"}}function x({model:t,projectCode:e,isCreate:o,from:r,processName:a}){const{t:n}=v(),s=c([]),i=c(!1),m=async()=>{if(i.value)return;i.value=!0;const f=await me(e);s.value=f.map(y=>({label:y.name,value:y.code})),i.value=!1},l=async f=>{if(!f)return;const y=await ae(f,e);t.definition=y},p=f=>{l(f)};return G(()=>{r===1&&a&&l(a),m()}),{type:"select",field:"processName",span:24,name:n("project.node.workflow_name"),props:{loading:i,disabled:!o,"on-update:value":p},validate:{trigger:["input","blur"],required:!0,validator(f,y){if(!y)return new Error(n("project.node.workflow_name_tips"))}},options:s}}function Ve({model:t,projectCode:e,from:o,processName:r,code:a}){const{t:n}=v(),s=c([]),i=c(!1),m=async()=>{if(i.value)return;i.value=!0;const p=await me(e);s.value=p.filter(f=>f.code!==a).map(f=>({label:f.name,value:f.code})),i.value=!1},l=async p=>{if(!p)return;const f=await ae(p,e);t.definition=f};return G(()=>{o===1&&r&&l(r),m()}),{type:"select",field:"processDefinitionCode",span:24,name:n("project.node.child_node"),props:{loading:i},options:s,class:"select-child-node",validate:{trigger:["input","blur"],required:!0,validator(p,f){if(!f)return Error(n("project.node.child_node_tips"))}}}}function Ue(){const{t}=v();return{type:"input",field:"targetJobName",name:t("project.node.target_task_name"),props:{placeholder:t("project.node.target_task_name_tips"),maxLength:100},validate:{trigger:["input","blur"],required:!0,message:t("project.node.target_task_name_tips")}}}function fe(t,e,o){const{t:r}=v(),a=c([]),n=c([]),s=[{id:0,code:"MYSQL",disabled:!1},{id:1,code:"POSTGRESQL",disabled:!1},{id:2,code:"HIVE",disabled:!1},{id:3,code:"SPARK",disabled:!1},{id:4,code:"CLICKHOUSE",disabled:!1},{id:5,code:"ORACLE",disabled:!1},{id:6,code:"SQLSERVER",disabled:!1},{id:7,code:"DB2",disabled:!1},{id:8,code:"PRESTO",disabled:!1},{id:9,code:"REDSHIFT",disabled:!1}],i=async()=>{a.value=s.filter(p=>p.disabled?!1:e?K.exports.indexOf(e,p.code)!==-1:!0).map(p=>({label:p.code,value:p.code}))},m=async()=>{const p={type:t.type},f=await z(p);n.value=f.map(y=>({label:y.name,value:y.id})),!f.length&&t.datasource&&(t.datasource=null),f.length&&t.datasource&&(K.exports.find(f,{id:t.datasource})||(t.datasource=null))},l=()=>{m()};return G(async()=>{i(),await le(),m()}),[{type:"select",field:o||"type",span:12,name:r("project.node.datasource_type"),props:{"on-update:value":l},options:a,validate:{trigger:["input","blur"],required:!0}},{type:"select",field:o||"datasource",span:12,name:r("project.node.datasource_instances"),options:n,validate:{trigger:["input","blur"],required:!0,validator(p,f){if(!f&&f!==0)return Error(r("project.node.datasource_instances"))}}}]}var J={"field-title":"_field-title_1hhfj_17","relaction-label":"_relaction-label_1hhfj_32","relaction-switch":"_relaction-switch_1hhfj_37","display-rows-tips":"_display-rows-tips_1hhfj_55"};function $e(t){const{t:e}=v(),o=S(()=>t.sqlType==="0"?6:0),r=S(()=>t.sqlType==="1"?18:0),a=S(()=>t.sqlType==="0"&&t.sendEmail?24:0),n=c([]),s=c(!1),i=[{value:"0",label:e("project.node.sql_type_query")},{value:"1",label:e("project.node.sql_type_non_query")}],m=async()=>{if(s.value)return;s.value=!0;const l=await He();n.value=l.map(p=>({label:p.groupName,value:p.id})),s.value=!1};return G(()=>{m()}),[{type:"select",field:"sqlType",span:6,name:e("project.node.sql_type"),options:i,validate:{trigger:["input","blur"],required:!0}},{type:"input",field:"segmentSeparator",name:e("project.node.segment_separator"),props:{placeholder:e("project.node.segment_separator_tips")},span:r},{type:"switch",field:"sendEmail",span:o,name:e("project.node.send_email")},{type:"select",field:"displayRows",span:o,name:e("project.node.log_display"),options:Be,props:{filterable:!0,tag:!0},validate:{trigger:["input","blur"],validator(l,p){if(!/^\+?[1-9][0-9]*$/.test(p))return new Error(e("project.node.integer_tips"))}}},{type:"custom",field:"displayRowsTips",span:o,widget:V("div",{class:J["display-rows-tips"]},e("project.node.rows_of_result"))},{type:"input",field:"title",name:e("project.node.title"),props:{placeholder:e("project.node.title_tips")},span:a,validate:{trigger:["input","blur"],required:!0,validator(l,p){if(t.sendEmail&&!p)return new Error(e("project.node.title_tips"))}}},{type:"select",field:"groupId",name:e("project.node.alarm_group"),options:n,span:a,props:{loading:s,placeholder:e("project.node.alarm_group_tips")},validate:{trigger:["input","blur"],required:!0,validator(l,p){if(t.sendEmail&&!p)return new Error(e("project.node.alarm_group_tips"))}}}]}const Be=[{label:"1",value:1},{label:"10",value:10},{label:"25",value:25},{label:"50",value:50},{label:"100",value:100}];function Je(t){const{t:e}=v();return[{type:"editor",field:"method",name:e("project.node.procedure_method"),props:{language:"sql",placeholder:e("project.node.procedure_method_tips")},validate:{trigger:["input","trigger"],required:!0,message:e("project.node.procedure_method_tips")}},...A({model:t,field:"localParams",isSimple:!1})]}function A({model:t,field:e,isSimple:o,name:r="custom_parameters",span:a=24}){const{t:n}=v();return o?[{type:"custom-parameters",field:e,name:n(`project.node.${r}`),class:"btn-custom-parameters",span:a,children:[{type:"input",field:"prop",span:10,class:"input-param-key",props:{placeholder:n("project.node.prop_tips"),maxLength:256},validate:{trigger:["input","blur"],required:!0,validator(s,i){if(!i)return new Error(n("project.node.prop_tips"));if(t[e].filter(l=>l.prop===i).length>1)return new Error(n("project.node.prop_repeat"))}}},{type:"input",field:"value",span:10,class:"input-param-value",props:{placeholder:n("project.node.value_tips"),maxLength:256}}]}]:[{type:"custom-parameters",field:e,name:n(`project.node.${r}`),class:"btn-custom-parameters",span:a,children:[{type:"input",field:"prop",span:6,class:"input-param-key",props:{placeholder:n("project.node.prop_tips"),maxLength:256},validate:{trigger:["input","blur"],required:!0,validator(s,i){if(!i)return new Error(n("project.node.prop_tips"));if(t[e].filter(l=>l.prop===i).length>1)return new Error(n("project.node.prop_repeat"))}}},{type:"select",field:"direct",span:4,options:We,value:"IN"},{type:"select",field:"type",span:6,options:Ke,value:"VARCHAR"},{type:"input",field:"value",span:6,class:"input-param-value",props:{placeholder:n("project.node.value_tips"),maxLength:256}}]}]}const Ke=[{value:"VARCHAR",label:"VARCHAR"},{value:"INTEGER",label:"INTEGER"},{value:"LONG",label:"LONG"},{value:"FLOAT",label:"FLOAT"},{value:"DOUBLE",label:"DOUBLE"},{value:"DATE",label:"DATE"},{value:"TIME",label:"TIME"},{value:"TIMESTAMP",label:"TIMESTAMP"},{value:"BOOLEAN",label:"BOOLEAN"},{value:"LIST",label:"LIST"}],We=[{value:"IN",label:"IN"},{value:"OUT",label:"OUT"}];function ye(t,e,o,r){const{t:a}=v(),n=c([]),s=c(!1),i=async m=>{if(s.value)return;s.value=!0;const l=await z({type:m});n.value=l.map(p=>({label:p.name,value:p.id})),s.value=!1};return G(()=>{i("MYSQL")}),[{type:"select",field:o,name:a("project.node.datasource"),span:e,options:[{label:"MYSQL",value:"MYSQL"}],validate:{required:!0}},{type:"select",field:r,name:" ",span:e,props:{placeholder:a("project.node.datasource_tips"),filterable:!0,loading:s},options:n,validate:{trigger:["blur","input"],validator(m,l){if(!l)return new Error(a("project.node.datasource_tips"))}}}]}function ze(t,e){const{t:o}=v(),r=c(24),a=c(0),n=c(24),s=c(0),i=c(0),m=c(0),l=c(12),p=()=>{r.value=e.value&&t.sourceType==="MYSQL"?24:0,a.value=r.value&&t.srcQueryType==="0"?24:0,n.value=r.value&&t.srcQueryType==="1"?24:0,s.value=a.value&&t.srcColumnType==="1"?24:0,i.value=e.value&&t.sourceType==="HIVE"?24:0,m.value=e.value&&t.sourceType==="HDFS"?24:0,l.value=e.value&&t.sourceType==="MYSQL"?12:0},f=c([{label:"MYSQL",value:"MYSQL"}]),y=b=>{switch(b){case"import":return[{label:"MYSQL",value:"MYSQL"}];case"export":return[{label:"HDFS",value:"HDFS"},{label:"HIVE",value:"HIVE"}];default:return[{label:"MYSQL",value:"MYSQL"},{label:"HDFS",value:"HDFS"},{label:"HIVE",value:"HIVE"}]}};return Y(()=>t.modelType,b=>{f.value=y(b),t.sourceType||(t.sourceType=f.value[0].value)}),Y(()=>[e.value,t.sourceType,t.srcQueryType,t.srcColumnType],()=>{p()}),[{type:"custom",field:"custom-title-source",span:e,widget:V("div",{class:J["field-title"]},o("project.node.data_source"))},{type:"select",field:"sourceType",name:o("project.node.type"),span:e,options:f},...ye(t,l,"sourceMysqlType","sourceMysqlDatasource"),{type:"radio",field:"srcQueryType",name:o("project.node.model_type"),span:r,options:[{label:o("project.node.form"),value:"0"},{label:"SQL",value:"1"}],props:{"on-update:value":b=>{t.targetType=b==="0"?"HIVE":"HDFS"}}},{type:"input",field:"srcTable",name:o("project.node.table"),span:a,props:{placeholder:o("project.node.table_tips")},validate:{trigger:["input","blur"],required:!0,validator(b,h){if(a.value&&!h)return new Error(o("project.node.table_tips"))}}},{type:"radio",field:"srcColumnType",name:o("project.node.column_type"),span:a,options:[{label:o("project.node.all_columns"),value:"0"},{label:o("project.node.some_columns"),value:"1"}]},{type:"input",field:"srcColumns",name:o("project.node.column"),span:s,props:{placeholder:o("project.node.column_tips")},validate:{trigger:["input","blur"],required:!0,validator(b,h){if(!!s.value&&!h)return new Error(o("project.node.column_tips"))}}},{type:"input",field:"sourceHiveDatabase",name:o("project.node.database"),span:i,props:{placeholder:o("project.node.database_tips")},validate:{trigger:["blur","input"],required:!0,validator(b,h){if(i.value&&!h)return new Error(o("project.node.database_tips"))}}},{type:"input",field:"sourceHiveTable",name:o("project.node.table"),span:i,props:{placeholder:o("project.node.hive_table_tips")},validate:{trigger:["blur","input"],required:!0,validator(b,h){if(i.value&&!h)return new Error(o("project.node.hive_table_tips"))}}},{type:"input",field:"sourceHivePartitionKey",name:o("project.node.hive_partition_keys"),span:i,props:{placeholder:o("project.node.hive_partition_keys_tips")}},{type:"input",field:"sourceHivePartitionValue",name:o("project.node.hive_partition_values"),span:i,props:{placeholder:o("project.node.hive_partition_values_tips")}},{type:"input",field:"sourceHdfsExportDir",name:o("project.node.export_dir"),span:m,props:{placeholder:o("project.node.export_dir_tips")},validate:{trigger:["blur","input"],required:!0,validator(b,h){if(m.value&&!h)return new Error(o("project.node.export_dir_tips"))}}},{type:"editor",field:"sourceMysqlSrcQuerySql",name:o("project.node.sql_statement"),span:n,validate:{trigger:["blur","input"],required:!0,validator(b,h){if(n.value&&!h)return new Error(o("project.node.sql_statement_tips"))}}},...A({model:t,field:"mapColumnHive",name:"map_column_hive",isSimple:!0,span:r}),...A({model:t,field:"mapColumnJava",name:"map_column_java",isSimple:!0,span:r})]}function Xe(t,e){const{t:o}=v(),r=c(0),a=c(24),n=c(0),s=c(0),i=c(0),m=()=>{r.value=e.value&&t.targetType==="HIVE"?24:0,a.value=e.value&&t.targetType==="HDFS"?24:0,n.value=e.value&&t.targetType==="MYSQL"?24:0,s.value=e.value&&t.targetType==="MYSQL"?12:0,i.value=n.value&&t.targetMysqlIsUpdate?24:0},l=c([{label:"HIVE",value:"HIVE"},{label:"HDFS",value:"HDFS"}]),p=(f,y)=>{switch(f){case"MYSQL":return y==="1"?[{label:"HDFS",value:"HDFS"}]:[{label:"HIVE",value:"HIVE"},{label:"HDFS",value:"HDFS"}];case"HDFS":case"HIVE":return[{label:"MYSQL",value:"MYSQL"}];default:return[{label:"HIVE",value:"HIVE"},{label:"HDFS",value:"HDFS"}]}};return Y(()=>[t.sourceType,t.srcQueryType],([f,y])=>{l.value=p(f,y),t.targetType||(t.targetType=l.value[0].value)}),Y(()=>[e.value,t.targetType,t.targetMysqlIsUpdate],()=>{m()}),[{type:"custom",field:"custom-title-target",span:e,widget:V("div",{class:J["field-title"]},o("project.node.data_target"))},{type:"select",field:"targetType",name:o("project.node.type"),span:e,options:l},{type:"input",field:"targetHiveDatabase",name:o("project.node.database"),span:r,props:{placeholder:o("project.node.database_tips")},validate:{trigger:["blur","input"],required:!0,validator(f,y){if(r.value&&!y)return new Error(o("project.node.database_tips"))}}},{type:"input",field:"targetHiveTable",name:o("project.node.table"),span:r,props:{placeholder:o("project.node.table")},validate:{trigger:["blur","input"],required:!0,validator(f,y){if(r.value&&!y)return new Error(o("project.node.hive_table_tips"))}}},{type:"switch",field:"targetHiveCreateTable",span:r,name:o("project.node.create_hive_table")},{type:"switch",field:"targetHiveDropDelimiter",span:r,name:o("project.node.drop_delimiter")},{type:"switch",field:"targetHiveOverWrite",span:r,name:o("project.node.over_write_src")},{type:"input",field:"targetHiveTargetDir",name:o("project.node.hive_target_dir"),span:r,props:{placeholder:o("project.node.hive_target_dir_tips")}},{type:"input",field:"targetHiveReplaceDelimiter",name:o("project.node.replace_delimiter"),span:r,props:{placeholder:o("project.node.replace_delimiter_tips")}},{type:"input",field:"targetHivePartitionKey",name:o("project.node.hive_partition_keys"),span:r,props:{placeholder:o("project.node.hive_partition_keys_tips")}},{type:"input",field:"targetHivePartitionValue",name:o("project.node.hive_partition_values"),span:r,props:{placeholder:o("project.node.hive_partition_values_tips")}},{type:"input",field:"targetHdfsTargetPath",name:o("project.node.target_dir"),span:a,props:{placeholder:o("project.node.target_dir_tips")},validate:{trigger:["blur","input"],required:!0,validator(f,y){if(a.value&&!y)return new Error(o("project.node.target_dir_tips"))}}},{type:"switch",field:"targetHdfsDeleteTargetDir",name:o("project.node.delete_target_dir"),span:a},{type:"radio",field:"targetHdfsCompressionCodec",name:o("project.node.compression_codec"),span:a,options:Ze},{type:"radio",field:"targetHdfsFileType",name:o("project.node.file_type"),span:a,options:et},{type:"input",field:"targetHdfsFieldsTerminated",name:o("project.node.fields_terminated"),span:a,props:{placeholder:o("project.node.fields_terminated_tips")}},{type:"input",field:"targetHdfsLinesTerminated",name:o("project.node.lines_terminated"),span:a,props:{placeholder:o("project.node.lines_terminated_tips")}},...ye(t,s,"targetMysqlType","targetMysqlDatasource"),{type:"input",field:"targetMysqlTable",name:o("project.node.table"),span:n,props:{placeholder:o("project.node.hive_table_tips")},validate:{trigger:["blur","input"],required:!0,validator(f,y){if(n.value&&!y)return new Error(o("project.node.table_tips"))}}},{type:"input",field:"targetMysqlColumns",name:o("project.node.column"),span:n,props:{placeholder:o("project.node.column_tips")}},{type:"input",field:"targetMysqlFieldsTerminated",name:o("project.node.fields_terminated"),span:n,props:{placeholder:o("project.node.fields_terminated_tips")}},{type:"input",field:"targetMysqlLinesTerminated",name:o("project.node.lines_terminated"),span:n,props:{placeholder:o("project.node.lines_terminated_tips")}},{type:"switch",field:"targetMysqlIsUpdate",span:n,name:o("project.node.is_update")},{type:"input",field:"targetMysqlTargetUpdateKey",name:o("project.node.update_key"),span:i,props:{placeholder:o("project.node.update_key_tips")}},{type:"radio",field:"targetMysqlUpdateMode",name:o("project.node.update_mode"),span:i,options:[{label:o("project.node.only_update"),value:"updateonly"},{label:o("project.node.allow_insert"),value:"allowinsert"}]}]}const Ze=[{label:"snappy",value:"snappy"},{label:"lzo",value:"lzo"},{label:"gzip",value:"gzip"},{label:"no",value:""}],et=[{label:"avro",value:"--as-avrodatafile"},{label:"sequence",value:"--as-sequencefile"},{label:"text",value:"--as-textfile"},{label:"parquet",value:"--as-parquetfile"}];function ve({model:t,children:e,childrenField:o,name:r}){const{t:a}=v(),n=S(()=>t.dependTaskList.length?3:0);return re(()=>{t.dependTaskList.forEach((s,i)=>{s[o].length===0&&t.dependTaskList.splice(i,1)})}),[{type:"custom",name:a(`project.node.${r}`),field:"relationLabel",span:24,class:J["relaction-label"]},{type:"switch",field:"relation",props:{round:!1,"checked-value":"AND","unchecked-value":"OR",size:"small"},slots:{checked:()=>a("project.node.and"),unchecked:()=>a("project.node.or")},span:n,class:J["relaction-switch"]},{type:"custom-parameters",field:"dependTaskList",span:20,children:[{type:"switch",field:"relation",props:{round:!1,"checked-value":"AND","unchecked-value":"OR",size:"small"},slots:{checked:()=>a("project.node.and"),unchecked:()=>a("project.node.or")},span:4,value:"AND",class:J["relaction-switch"]},e]}]}function tt(t){const{t:e}=v(),o=S(()=>t.timeoutShowFlag?24:0),r=S(()=>t.timeoutFlag?12:0),a=[{label:e("project.node.timeout_alarm"),value:"WARN"},{label:e("project.node.timeout_failure"),value:"FAILED"}];return Y(()=>t.timeoutFlag,n=>{t.timeoutNotifyStrategy=n?["WARN"]:[],t.timeout=n?30:null}),[{type:"switch",field:"timeoutShowFlag",name:e("project.node.timeout_alarm")},{type:"switch",field:"timeoutFlag",name:e("project.node.waiting_dependent_complete"),props:{"on-update:value":n=>{t.timeoutNotifyStrategy=n?["WARN"]:null,t.timeout=n?30:null}},span:o},{type:"input-number",field:"timeout",name:e("project.node.timeout_period"),span:r,props:{max:Math.pow(9,10)-1},slots:{suffix:()=>e("project.node.minute")},validate:{trigger:["input"],validator(n,s){if(t.timeoutFlag&&!/^[1-9]\d*$/.test(String(s)))return new Error(e("project.node.timeout_period_tips"))}}},{type:"checkbox",field:"timeoutNotifyStrategy",name:e("project.node.timeout_strategy"),options:a,span:r,validate:{trigger:["input"],validator(n,s){if(t.waitCompleteTimeoutEnable&&!s.length)return new Error(e("project.node.timeout_strategy_tips"))}}}]}function rt(t,e){const{t:o}=v(),r=c([]),a=c(!1),n=c([]),s=c([]),i=c([]),m=c([]),l=c([]),p=c([]),f=c([]),y=S(()=>t.comparison_type===1?24:0);let b=0;const h=async()=>{if(a.value)return;a.value=!0;const d=await Qe();r.value=d.map(u=>{let T="";return u.name&&(T=u.name.replace("$t(","").replace(")","")),{value:u.id,label:T?o(`project.node.${T}`):""}}),a.value=!1},g=async d=>{if(a.value)return;a.value=!0;const u=await Ge(d),T=JSON.parse(u).map(E=>_(E));e(T,b),b=T.length,a.value=!1},_=d=>{var E;const u={field:d.field,options:d.options,validate:d.validate,props:d.props,value:d.value},T=(E=d.name)==null?void 0:E.replace("$t(","").replace(")","");return u.name=T?o(`project.node.${T}`):"",d.type!=="group"?u.type=d.type:(u.type="custom-parameters",u.children=u.props.rules.map($=>($.span=Math.floor(22/u.props.rules.length),$)),t[u.field]=t[u.field]||[],delete u.props.rules),d.emit&&d.emit.forEach($=>{$==="change"&&(u.props.onUpdateValue=F=>{j(F,u.field,!0)})}),d.props.placeholder&&(u.props.placeholder=o("project.node."+d.props.placeholder.split(" ").join("_").split(",").join("").toLowerCase())),u.field==="src_datasource_id"&&(u.options=n),u.field==="target_datasource_id"&&(u.options=m),u.field==="writer_datasource_id"&&(u.options=f),u.field==="src_table"&&(u.options=s),u.field==="target_table"&&(u.options=l),u.field==="src_field"&&(u.options=i),u.field==="target_field"&&(u.options=p),t[u.field]!==void 0&&(j(t[u.field],u.field,!1),u.value=t[u.field]),u},j=async(d,u,T)=>{if(u==="src_connector_type"&&typeof d=="number"){const E=await ee(d);n.value=E||[],T&&(s.value=[],t.src_datasource_id=null,t.src_table=null,t.src_field=null);return}if(u==="target_connector_type"&&typeof d=="number"){const E=await ee(d);m.value=E||[],T&&(l.value=[],t.target_datasource_id=null,t.target_table=null,t.target_field=null);return}if(u==="writer_connector_type"&&typeof d=="number"){const E=await ee(d);f.value=E||[],T&&(t.writer_datasource_id=null);return}if(u==="src_datasource_id"&&typeof d=="number"){const E=await se(d);s.value=E||[],T&&(t.src_table=null,t.src_field=null)}if(u==="target_datasource_id"&&typeof d=="number"){const E=await se(d);l.value=E||[],T&&(t.target_table=null,t.target_field=null)}if(u==="src_table"&&typeof d=="string"){const E=await ie(t.src_datasource_id,d);i.value=E||[],T&&(t.src_field=null)}if(u==="target_table"&&typeof d=="string"){const E=await ie(t.target_datasource_id,d);p.value=E||[],T&&(t.target_field=null)}};return G(async()=>{await h(),await g(t.ruleId)}),[{type:"select",field:"ruleId",name:o("project.node.rule_name"),props:{loading:a,onUpdateValue:g},options:r},{type:"input",field:"comparison_name",name:o("project.node.fix_value"),props:{placeholder:o("project.node.fix_value")},span:y}]}function X(t=24,e=c(!0),o=c(!0)){const{t:r}=v(),a=c(pe);return re(()=>{a.value=pe.filter(n=>{switch(n.value){case"cluster":return o.value;case"client":return e.value;default:return!0}})}),{type:"radio",field:"deployMode",name:r("project.node.deploy_mode"),options:a,span:t}}const pe=[{label:"cluster",value:"cluster"},{label:"client",value:"client"},{label:"local",value:"local"}];function _e(){const{t}=v();return{type:"input-number",field:"driverCores",name:t("project.node.driver_cores"),span:12,props:{placeholder:t("project.node.driver_cores_tips"),min:1},validate:{trigger:["input","blur"],required:!0,validator(e,o){if(!o)return new Error(t("project.node.driver_cores_tips"))}}}}function ge(){const{t}=v();return{type:"input",field:"driverMemory",name:t("project.node.driver_memory"),span:12,props:{placeholder:t("project.node.driver_memory_tips")},validate:{trigger:["input","blur"],required:!0,validator(e,o){if(!o)return new Error(t("project.node.driver_memory_tips"));if(!Number.isInteger(parseInt(o)))return new Error(t("project.node.driver_memory")+t("project.node.positive_integer_tips"))}}}}function je(){const{t}=v();return{type:"input-number",field:"numExecutors",name:t("project.node.executor_number"),span:12,props:{placeholder:t("project.node.executor_number_tips"),min:1},validate:{trigger:["input","blur"],required:!0,validator(e,o){if(!o)return new Error(t("project.node.executor_number_tips"))}}}}function be(){const{t}=v();return{type:"input",field:"executorMemory",name:t("project.node.executor_memory"),span:12,props:{placeholder:t("project.node.executor_memory_tips")},validate:{trigger:["input","blur"],required:!0,validator(e,o){if(!o)return new Error(t("project.node.executor_memory_tips"));if(!Number.isInteger(parseInt(o)))return new Error(t("project.node.executor_memory_tips")+t("project.node.positive_integer_tips"))}}}}function Te(){const{t}=v();return{type:"input-number",field:"executorCores",name:t("project.node.executor_cores"),span:12,props:{placeholder:t("project.node.executor_cores_tips"),min:1},validate:{trigger:["input","blur"],required:!0,validator(e,o){if(!o)return new Error(t("project.node.executor_cores_tips"))}}}}function oe(t){const{t:e}=v(),o=c([]),r=U(),a=S(()=>t.programType==="SQL"?0:24),n=async s=>{const i=r.getMainJar(s);if(i){o.value=i;return}const m=await De({type:"FILE",programType:s});ue.removeUselessChildren(m),o.value=m||[],r.updateMainJar(s,m)};return G(()=>{n(t.programType)}),Y(()=>t.programType,s=>{s!=="SQL"&&n(s)}),{type:"tree-select",field:"mainJar",name:e("project.node.main_package"),span:a,props:{cascade:!0,showPath:!0,checkStrategy:"child",placeholder:e("project.node.main_package_tips"),keyField:"id",labelField:"fullName"},validate:{trigger:["input","blur"],required:t.programType!=="SQL",validator(s,i){if(!i&&t.programType!=="SQL")return new Error(e("project.node.main_package_tips"))}},options:o}}function W(){const{t}=v(),e=c([]),o=c(!1),r=U(),a=async()=>{if(r.resources.length){e.value=r.resources;return}if(o.value)return;o.value=!0;const n=await Me({type:"FILE"});ue.removeUselessChildren(n),e.value=n||[],o.value=!1,r.updateResource(n)};return G(()=>{a()}),{type:"tree-select",field:"resourceList",name:t("project.node.resources"),options:e,props:{multiple:!0,checkable:!0,cascade:!0,showPath:!0,checkStrategy:"child",placeholder:t("project.node.resources_tips"),keyField:"id",labelField:"name",loading:o}}}function Se(t){const{t:e}=v();return[{type:"editor",field:"rawScript",name:e("project.node.script"),validate:{trigger:["input","trigger"],required:!0,message:e("project.node.script_tips")}},W(),...A({model:t,field:"localParams",isSimple:!1})]}function at(t){const{t:e}=v(),o=S(()=>t.programType==="PYTHON"||t.programType==="SQL"?0:24),r=S(()=>t.programType==="SQL"?0:24),a=S(()=>t.programType==="SQL"?24:0),n=S(()=>t.programType!=="SQL");return[{type:"select",field:"programType",span:12,name:e("project.node.program_type"),options:ot,props:{"on-update:value":()=>{t.mainJar=null,t.mainClass=""}}},{type:"select",field:"sparkVersion",span:12,name:e("project.node.spark_version"),options:nt},{type:"input",field:"mainClass",span:o,name:e("project.node.main_class"),props:{placeholder:e("project.node.main_class_tips")},validate:{trigger:["input","blur"],required:t.programType!=="PYTHON"&&t.programType!=="SQL",validator(s,i){if(t.programType!=="PYTHON"&&!i&&t.programType!=="SQL")return new Error(e("project.node.main_class_tips"))}}},oe(t),{type:"editor",field:"rawScript",span:a,name:e("project.node.script"),validate:{trigger:["input","trigger"],required:!0,message:e("project.node.script_tips")}},X(24,c(!0),n),{type:"input",field:"appName",name:e("project.node.app_name"),props:{placeholder:e("project.node.app_name_tips")}},_e(),ge(),je(),be(),Te(),{type:"input",field:"mainArgs",span:r,name:e("project.node.main_arguments"),props:{type:"textarea",placeholder:e("project.node.main_arguments_tips")}},{type:"input",field:"others",name:e("project.node.option_parameters"),props:{type:"textarea",placeholder:e("project.node.option_parameters_tips")}},W(),...A({model:t,field:"localParams",isSimple:!0})]}const ot=[{label:"JAVA",value:"JAVA"},{label:"SCALA",value:"SCALA"},{label:"PYTHON",value:"PYTHON"},{label:"SQL",value:"SQL"}],nt=[{label:"SPARK2",value:"SPARK2"},{label:"SPARK1",value:"SPARK1"}];function st(t){const{t:e}=v(),o=S(()=>t.programType==="PYTHON"||t.programType==="SQL"?0:24);return[{type:"select",field:"programType",span:12,name:e("project.node.program_type"),options:it,props:{"on-update:value":()=>{t.mainJar=null,t.mainClass=""}},value:t.programType},{type:"input",field:"mainClass",span:o,name:e("project.node.main_class"),props:{placeholder:e("project.node.main_class_tips")},validate:{trigger:["input","blur"],required:t.programType!=="PYTHON",validator(r,a){if(t.programType!=="PYTHON"&&!a)return new Error(e("project.node.main_class_tips"))}}},oe(t),{type:"input",field:"appName",name:e("project.node.app_name"),props:{placeholder:e("project.node.app_name_tips")}},{type:"input",field:"mainArgs",name:e("project.node.main_arguments"),props:{type:"textarea",placeholder:e("project.node.main_arguments_tips")}},{type:"input",field:"others",name:e("project.node.option_parameters"),props:{type:"textarea",placeholder:e("project.node.option_parameters_tips")}},W(),...A({model:t,field:"localParams",isSimple:!0})]}const it=[{label:"JAVA",value:"JAVA"},{label:"SCALA",value:"SCALA"},{label:"PYTHON",value:"PYTHON"}];function pt(t){const{t:e}=v(),o=S(()=>t.programType==="PYTHON"||t.programType==="SQL"?0:24),r=S(()=>t.programType==="SQL"?0:24),a=S(()=>t.programType==="SQL"?24:0),n=S(()=>t.programType==="SQL"?[{label:">=1.13",value:">=1.13"}]:ut),s=S(()=>t.flinkVersion==="<1.10"&&t.deployMode==="cluster"?12:0),i=S(()=>t.deployMode==="cluster"?12:0),m=S(()=>t.deployMode==="cluster"?24:0);return re(()=>{t.flinkVersion=t.programType==="SQL"?">=1.13":"<1.10"}),[{type:"select",field:"programType",span:12,name:e("project.node.program_type"),options:lt,props:{"on-update:value":()=>{t.mainJar=null,t.mainClass=""}}},{type:"input",field:"mainClass",span:o,name:e("project.node.main_class"),props:{placeholder:e("project.node.main_class_tips")},validate:{trigger:["input","blur"],required:t.programType!=="PYTHON"&&t.programType!=="SQL",validator(l,p){if(t.programType!=="PYTHON"&&!p&&t.programType!=="SQL")return new Error(e("project.node.main_class_tips"))}}},oe(t),X(24,c(!1)),{type:"editor",field:"initScript",span:a,name:e("project.node.init_script"),validate:{trigger:["input","trigger"],required:!1,message:e("project.node.init_script_tips")}},{type:"editor",field:"rawScript",span:a,name:e("project.node.script"),validate:{trigger:["input","trigger"],required:!0,message:e("project.node.script_tips")}},{type:"select",field:"flinkVersion",name:e("project.node.flink_version"),options:n,value:t.flinkVersion,span:i},{type:"input",field:"appName",name:e("project.node.app_name"),props:{placeholder:e("project.node.app_name_tips")},span:m},{type:"input",field:"jobManagerMemory",name:e("project.node.job_manager_memory"),span:i,props:{placeholder:e("project.node.job_manager_memory_tips"),min:1},validate:{trigger:["input","blur"],validator(l,p){if(!!p&&!Number.isInteger(parseInt(p)))return new Error(e("project.node.job_manager_memory_tips")+e("project.node.positive_integer_tips"))}}},{type:"input",field:"taskManagerMemory",name:e("project.node.task_manager_memory"),span:i,props:{placeholder:e("project.node.task_manager_memory_tips")},validate:{trigger:["input","blur"],validator(l,p){if(!!p&&!Number.isInteger(parseInt(p)))return new Error(e("project.node.task_manager_memory")+e("project.node.positive_integer_tips"))}},value:t.taskManagerMemory},{type:"input-number",field:"slot",name:e("project.node.slot_number"),span:i,props:{placeholder:e("project.node.slot_number_tips"),min:1},value:t.slot},{type:"input-number",field:"taskManager",name:e("project.node.task_manager_number"),span:s,props:{placeholder:e("project.node.task_manager_number_tips"),min:1},value:t.taskManager},{type:"input-number",field:"parallelism",name:e("project.node.parallelism"),span:12,props:{placeholder:e("project.node.parallelism_tips"),min:1},validate:{trigger:["input","blur"],required:!0,validator(l,p){if(!p)return new Error(e("project.node.parallelism_tips"))}},value:t.parallelism},{type:"input",field:"mainArgs",span:r,name:e("project.node.main_arguments"),props:{type:"textarea",placeholder:e("project.node.main_arguments_tips")}},{type:"input",field:"others",name:e("project.node.option_parameters"),props:{type:"textarea",placeholder:e("project.node.option_parameters_tips")}},W(),...A({model:t,field:"localParams",isSimple:!0})]}const lt=[{label:"JAVA",value:"JAVA"},{label:"SCALA",value:"SCALA"},{label:"PYTHON",value:"PYTHON"},{label:"SQL",value:"SQL"}],ut=[{label:"<1.10",value:"<1.10"},{label:">=1.10",value:">=1.10"}];function ct(t){const{t:e}=v(),o=[{label:e("project.node.status_code_default"),value:"STATUS_CODE_DEFAULT"},{label:e("project.node.status_code_custom"),value:"STATUS_CODE_CUSTOM"},{label:e("project.node.body_contains"),value:"BODY_CONTAINS"},{label:e("project.node.body_not_contains"),value:"BODY_NOT_CONTAINS"}];return[{type:"input",field:"url",name:e("project.node.http_url"),props:{placeholder:e("project.node.http_url_tips")},validate:{trigger:["input","blur"],required:!0,validator(r,a){if(!a)return new Error(e("project.node.http_url_tips"));if(a.search(new RegExp(/http[s]{0,1}:\/\/\S*/,"i")))return new Error(e("project.node.http_url_validator"))}}},{type:"select",field:"httpMethod",span:12,name:e("project.node.http_method"),options:dt},{type:"custom-parameters",field:"httpParams",name:e("project.node.http_parameters"),children:[{type:"input",field:"prop",span:6,props:{placeholder:e("project.node.prop_tips"),maxLength:256},validate:{trigger:["input","blur"],required:!0,validator(r,a){if(!a)return new Error(e("project.node.prop_tips"));if(t.httpParams.filter(s=>s.prop===a).length>1)return new Error(e("project.node.prop_repeat"))}}},{type:"select",field:"httpParametersType",span:6,options:mt,value:"PARAMETER"},{type:"input",field:"value",span:6,props:{placeholder:e("project.node.value_tips"),maxLength:256},validate:{trigger:["input","blur"],required:!0,validator(r,a){if(!a)return new Error(e("project.node.value_required_tips"))}}}]},{type:"select",field:"httpCheckCondition",name:e("project.node.http_check_condition"),options:o},{type:"input",field:"condition",name:e("project.node.http_condition"),props:{type:"textarea",placeholder:e("project.node.http_condition_tips")}},{type:"input-number",field:"connectTimeout",name:e("project.node.connect_timeout"),span:12,props:{max:Math.pow(7,10)-1},slots:{suffix:()=>e("project.node.ms")},validate:{trigger:["input","blur"],validator(r,a){if(!Number.isInteger(parseInt(a)))return new Error(e("project.node.connect_timeout")+e("project.node.positive_integer_tips"))}}},{type:"input-number",field:"socketTimeout",name:e("project.node.socket_timeout"),span:12,props:{max:Math.pow(7,10)-1},slots:{suffix:()=>e("project.node.ms")},validate:{trigger:["input","blur"],validator(r,a){if(!Number.isInteger(parseInt(a)))return new Error(e("project.node.socket_timeout")+e("project.node.positive_integer_tips"))}}},...A({model:t,field:"localParams",isSimple:!0})]}const dt=[{value:"GET",label:"GET"},{value:"POST",label:"POST"},{value:"HEAD",label:"HEAD"},{value:"PUT",label:"PUT"},{value:"DELETE",label:"DELETE"}],mt=[{value:"PARAMETER",label:"Parameter"},{value:"BODY",label:"Body"},{value:"HEADERS",label:"Headers"}];function ft(t){const{t:e}=v(),o=c([]),r=c(!1),a=S(()=>["HIVE","SPARK"].includes(t.type)?24:0),n=async()=>{if(r.value)return;r.value=!0;const s=await Ae({type:t.type});o.value=s.map(i=>({value:String(i.id),label:i.funcName})),r.value=!1};return Y(()=>t.type,s=>{["HIVE","SPARK"].includes(s)&&n()}),{type:"select",field:"udfs",options:o,name:e("project.node.udf_function"),props:{multiple:!0,loading:r},span:a}}function yt(t){const{t:e}=v(),o=S(()=>t.type==="HIVE"?24:0);return[{type:"input",field:"connParams",name:e("project.node.sql_parameter"),props:{placeholder:e("project.node.format_tips")+" key1=value1;key2=value2..."},span:o},{type:"editor",field:"sql",name:e("project.node.sql_statement"),validate:{trigger:["input","trigger"],required:!0,message:e("project.node.sql_empty_tips")}},ft(t),...A({model:t,field:"localParams",isSimple:!1}),{type:"multi-input",field:"preStatements",name:e("project.node.pre_sql_statement"),span:22,props:{placeholder:e("project.node.sql_input_placeholder"),type:"textarea",autosize:{minRows:1}}},{type:"multi-input",field:"postStatements",name:e("project.node.post_sql_statement"),span:22,props:{placeholder:e("project.node.sql_input_placeholder"),type:"textarea",autosize:{minRows:1}}}]}function vt(t){const{t:e}=v(),o=S(()=>t.isCustomTask?24:0),r=S(()=>t.isCustomTask?0:24);return[{type:"switch",field:"isCustomTask",name:e("project.node.custom_job")},{type:"input",field:"jobName",name:e("project.node.sqoop_job_name"),span:r,props:{placeholder:e("project.node.sqoop_job_name_tips")},validate:{trigger:["input","blur"],required:!0,validator(a,n){if(!t.isCustomTask&&!n)return new Error(e("project.node.sqoop_job_name_tips"))}}},{type:"select",field:"modelType",name:e("project.node.direct"),span:r,options:_t},...A({model:t,field:"hadoopCustomParams",name:"hadoop_custom_params",isSimple:!0,span:r}),...A({model:t,field:"sqoopAdvancedParams",name:"sqoop_advanced_parameters",isSimple:!0,span:r}),...ze(t,r),...Xe(t,r),{type:"input-number",field:"concurrency",name:e("project.node.concurrency"),span:r,props:{placeholder:e("project.node.concurrency_tips"),min:1}},{type:"editor",field:"customShell",name:e("project.node.custom_script"),span:o,validate:{trigger:["input","trigger"],required:!0,validator(a,n){if(o.value&&!n)return new Error(e("project.node.custom_script"))}}},...A({model:t,field:"localParams",name:"custom_parameters",isSimple:!0})]}const _t=[{label:"import",value:"import"},{label:"export",value:"export"}];function gt(t){const{t:e}=v(),o=[{label:"yarn",value:"yarn"},{label:"local",value:"local"},{label:"spark://",value:"spark://"},{label:"mesos://",value:"mesos://"}],r=[{label:"default",value:"default"}],a=S(()=>t.deployMode==="local"?0:12),n=S(()=>t.deployMode==="local"||t.master!="yarn"?0:12),s=S(()=>t.deployMode==="local"||t.master!="spark://"&&t.master!="mesos://"?0:12),i="sh ${WATERDROP_HOME}/bin/start-waterdrop.sh",m=()=>{t.rawScript&&t.rawScript.split(`
`).forEach(l=>{const p=l.replace(i,"").split("--");p==null||p.forEach(f=>{const y=f.split(" ");if(y&&y.length>=2)if(y[0]==="master"){const b=y[1].substring(0,8);y[1]&&(b==="mesos://"||b==="spark://")?(t.master=b,t.masterUrl=y[1].substring(8,y[1].length)):t.master=y[1]}else y[0]==="deploy-mode"?t.deployMode=y[1]:y[0]==="queue"&&(t.queue=y[1])})})};return Y(()=>t.rawScript,()=>{m()}),[X(),{type:"select",field:"master",name:e("project.node.sea_tunnel_master"),options:o,value:t.master,span:a},{type:"input",field:"masterUrl",name:e("project.node.sea_tunnel_master_url"),value:t.masterUrl,span:s,props:{placeholder:e("project.node.sea_tunnel_master_url_tips")}},{type:"select",field:"queue",name:e("project.node.sea_tunnel_queue"),options:r,value:t.queue,span:n},W(),...A({model:t,field:"localParams",isSimple:!0})]}function jt(t,e){const{t:o}=v(),r=U(),a=c(r.postTaskOptions),n=c(!1),s=async()=>{if(n.value)return;n.value=!0,a.value=[];const m=await ae(t.processName,e);m==null||m.taskDefinitionList.forEach(l=>{l.code!=t.code&&a.value.push({label:l.name,value:l.code})}),n.value=!1,i(a.value)},i=m=>{var l,p;if(!m||!m.length){t.nextNode=null,(l=t.dependTaskList)==null||l.forEach(f=>{f.nextNode=null});return}K.exports.findIndex(a.value,f=>f.value==t.nextNode)===-1&&(t.nextNode=null),(p=t.dependTaskList)==null||p.forEach(f=>{K.exports.findIndex(a.value,y=>y.value==f.nextNode)===-1&&(f.nextNode=null)})};return Y(()=>[t.processName,t.nextCode],()=>{t.processName&&s()}),G(async()=>{await le(),i(a.value)}),[{type:"custom-parameters",field:"dependTaskList",name:o("project.node.switch_condition"),children:[{type:"input",field:"condition",span:24,props:{loading:n,type:"textarea",autosize:{minRows:2}}},{type:"select",field:"nextNode",span:22,name:o("project.node.switch_branch_flow"),options:a}]},{type:"select",field:"nextNode",span:24,name:o("project.node.switch_branch_flow"),props:{loading:n},options:a}]}function bt(t){const{t:e}=v(),o=[{id:0,code:"MYSQL",disabled:!1},{id:1,code:"POSTGRESQL",disabled:!1},{id:2,code:"HIVE",disabled:!0},{id:3,code:"SPARK",disabled:!0},{id:4,code:"CLICKHOUSE",disabled:!1},{id:5,code:"ORACLE",disabled:!1},{id:6,code:"SQLSERVER",disabled:!1},{id:7,code:"DB2",disabled:!0},{id:8,code:"PRESTO",disabled:!0}],r=c([]),a=c([]),n=c([]),s=[{label:`0(${e("project.node.unlimited")})`,value:0},{label:"1KB",value:1024},{label:"10KB",value:10240},{label:"50KB",value:51200},{label:"100KB",value:102400},{label:"512KB",value:524288}],i=[{label:`0(${e("project.node.unlimited")})`,value:0},{label:"500",value:500},{label:"1000",value:1e3},{label:"1500",value:1500},{label:"2000",value:2e3},{label:"2500",value:2500},{label:"3000",value:3e3}],m=[{label:"1G",value:1},{label:"2G",value:2},{label:"3G",value:3},{label:"4G",value:4}],l=c(!1),p=async()=>{l.value||(l.value=!0,r.value=o.filter(F=>!F.disabled).map(F=>({label:F.code,value:F.code})),l.value=!1)},f=async()=>{const F={type:t.dsType},B=await z(F);a.value=[],B.map(Q=>{a.value.push({label:Q.name,value:String(Q.id)})}),a.value&&t.dataSource&&(K.exports.find(a.value,{value:String(t.dataSource)})||(t.dataSource=null))},y=async()=>{const F={type:t.dtType},B=await z(F);n.value=[],B.map(Q=>{n.value.push({label:Q.name,value:String(Q.id)})}),n.value&&t.dataTarget&&(K.exports.find(n.value,{value:String(t.dataTarget)})||(t.dataTarget=null))},b=c(24),h=c(0),g=c(12),_=c(8),j=c(22),d=c(12),u=c(0),T=()=>{t.customConfig?(b.value=0,h.value=24,g.value=0,_.value=0,j.value=0,d.value=0,u.value=24):(b.value=24,h.value=0,g.value=12,_.value=8,j.value=22,d.value=12,u.value=0)};G(()=>{p(),f(),y(),T()});const E=F=>{t.dsType=F,f()},$=F=>{t.dtType=F,y()};return Y(()=>t.customConfig,()=>{T()}),[{type:"switch",field:"customConfig",name:e("project.node.datax_custom_template")},{type:"select",field:"dsType",span:g,name:e("project.node.datasource_type"),props:{loading:l,"on-update:value":E},options:r,validate:{trigger:["input","blur"],required:!0}},{type:"select",field:"dataSource",span:g,name:e("project.node.datasource_instances"),props:{loading:l},options:a,validate:{trigger:["input","blur"],required:!0}},{type:"editor",field:"sql",name:e("project.node.sql_statement"),span:b,validate:{trigger:["input","trigger"],required:!0,message:e("project.node.sql_empty_tips")}},{type:"editor",field:"json",name:e("project.node.datax_json_template"),span:h,validate:{trigger:["input","trigger"],required:!0,message:e("project.node.sql_empty_tips")}},{type:"select",field:"dtType",name:e("project.node.datax_target_datasource_type"),span:_,props:{loading:l,"on-update:value":$},options:r,validate:{trigger:["input","blur"],required:!0}},{type:"select",field:"dataTarget",name:e("project.node.datax_target_database"),span:_,props:{loading:l},options:n,validate:{trigger:["input","blur"],required:!0}},{type:"input",field:"targetTable",name:e("project.node.datax_target_table"),span:_,props:{placeholder:e("project.node.datax_target_table_tips")},validate:{trigger:["input","blur"],required:!0}},{type:"multi-input",field:"preStatements",name:e("project.node.datax_target_database_pre_sql"),span:j,props:{placeholder:e("project.node.datax_non_query_sql_tips"),type:"textarea",autosize:{minRows:1}}},{type:"multi-input",field:"postStatements",name:e("project.node.datax_target_database_post_sql"),span:j,props:{placeholder:e("project.node.datax_non_query_sql_tips"),type:"textarea",autosize:{minRows:1}}},{type:"select",field:"jobSpeedByte",name:e("project.node.datax_job_speed_byte"),span:d,options:s,value:0},{type:"select",field:"jobSpeedRecord",name:e("project.node.datax_job_speed_record"),span:d,options:i,value:1e3},{type:"custom-parameters",field:"localParams",name:e("project.node.custom_parameters"),span:u,children:[{type:"input",field:"prop",span:10,props:{placeholder:e("project.node.prop_tips"),maxLength:256},validate:{trigger:["input","blur"],required:!0,validator(F,B){if(!B)return new Error(e("project.node.prop_tips"));if(t.localParams.filter(he=>he.prop===B).length>1)return new Error(e("project.node.prop_repeat"))}}},{type:"input",field:"value",span:10,props:{placeholder:e("project.node.value_tips"),maxLength:256}}]},{type:"select",field:"xms",name:e("project.node.datax_job_runtime_memory_xms"),span:12,options:m,value:1},{type:"select",field:"xmx",name:e("project.node.datax_job_runtime_memory_xmx"),span:12,options:m,value:1}]}function Tt(t){const{t:e}=v(),o=U(),r=o.preTaskOptions.filter(n=>o.preTasks.includes(Number(n.value))),a=[{label:e("project.node.success"),value:"success"},{label:e("project.node.failed"),value:"failed"}];return[{type:"select",field:"successNode",name:e("project.node.state"),span:12,props:{disabled:!0},options:a},{type:"select",field:"successBranch",name:e("project.node.branch_flow"),span:12,props:{clearable:!0},validate:{trigger:["input","blur"],validator:(n,s)=>{if(s&&s===t.failedBranch)return new Error(e("project.node.branch_tips"))}},options:o.getPostTaskOptions},{type:"select",field:"failedNode",name:e("project.node.state"),span:12,props:{disabled:!0},options:a},{type:"select",field:"failedBranch",name:e("project.node.branch_flow"),span:12,props:{clearable:!0},validate:{trigger:["input","blur"],validator:(n,s)=>{if(s&&s===t.successBranch)return new Error(e("project.node.branch_tips"))}},options:o.getPostTaskOptions},...M(t),...ve({model:t,children:{type:"custom-parameters",field:"dependItemList",span:18,children:[{type:"select",field:"depTaskCode",span:10,options:r},{type:"select",field:"status",span:10,options:[{value:"SUCCESS",label:e("project.node.success")},{value:"FAILURE",label:e("project.node.failed")}]}]},childrenField:"dependItemList",name:"add_pre_task_check_condition"})]}function St(t){const{t:e}=v(),o=ce(),a=U().getDependentResult,n=Ye(e),s=c([]),i={},m={},l=[{value:"month",label:e("project.node.month")},{value:"week",label:e("project.node.week")},{value:"day",label:e("project.node.day")},{value:"hour",label:e("project.node.hour")}],p={hour:[{value:"currentHour",label:e("project.node.current_hour")},{value:"last1Hour",label:e("project.node.last_1_hour")},{value:"last2Hours",label:e("project.node.last_2_hour")},{value:"last3Hours",label:e("project.node.last_3_hour")},{value:"last24Hours",label:e("project.node.last_24_hour")}],day:[{value:"today",label:e("project.node.today")},{value:"last1Days",label:e("project.node.last_1_days")},{value:"last2Days",label:e("project.node.last_2_days")},{value:"last3Days",label:e("project.node.last_3_days")},{value:"last7Days",label:e("project.node.last_7_days")}],week:[{value:"thisWeek",label:e("project.node.this_week")},{value:"lastWeek",label:e("project.node.last_week")},{value:"lastMonday",label:e("project.node.last_monday")},{value:"lastTuesday",label:e("project.node.last_tuesday")},{value:"lastWednesday",label:e("project.node.last_wednesday")},{value:"lastThursday",label:e("project.node.last_thursday")},{value:"lastFriday",label:e("project.node.last_friday")},{value:"lastSaturday",label:e("project.node.last_saturday")},{value:"lastSunday",label:e("project.node.last_sunday")}],month:[{value:"thisMonth",label:e("project.node.this_month")},{value:"thisMonthBegin",label:e("project.node.this_month_begin")},{value:"lastMonth",label:e("project.node.last_month")},{value:"lastMonthBegin",label:e("project.node.last_month_begin")},{value:"lastMonthEnd",label:e("project.node.last_month_end")}]},f=async()=>{const g=await Fe();return s.value=g.map(_=>({value:_.code,label:_.name})),s},y=async g=>{if(i[g])return i[g];const j=(await Oe(g)).map(d=>({value:d.code,label:d.name}));return i[g]=j,j},b=async(g,_)=>{if(m[_])return m[_];const d=(await xe(g,_)).map(u=>({value:u.code,label:u.name}));return d.unshift({value:0,label:"ALL"}),m[_]=d,d},h=g=>{if(!g||o.currentRoute.value.name!=="workflow-instance-detail")return null;const _=`${g.definitionCode}-${g.depTaskCode}-${g.cycle}-${g.dateValue}`,j=a[_]||"WAITING_THREAD";return V(de,{size:24,color:n[j].color},()=>V(n[j].icon))};return G(()=>{f()}),Y(()=>t.dependTaskList,g=>{g.forEach(_=>{var j,d;!((j=_.dependItemList)!=null&&j.length)||(d=_.dependItemList)==null||d.forEach(async u=>{u.projectCode&&(u.definitionCodeOptions=await y(u.projectCode)),u.projectCode&&u.definitionCode&&(u.depTaskCodeOptions=await b(u.projectCode,u.definitionCode)),u.cycle&&(u.dateOptions=p[u.cycle])})})}),[...tt(t),...ve({model:t,children:(g=0)=>({type:"custom-parameters",field:"dependItemList",span:18,children:[(_=0)=>({type:"select",field:"projectCode",name:e("project.node.project_name"),span:24,props:{filterable:!0,onUpdateValue:async j=>{const d=t.dependTaskList[g].dependItemList[_];d.definitionCodeOptions=await y(j),d.depTaskCode=null,d.definitionCode=null}},options:s,path:`dependTaskList.${g}.dependItemList.${_}.projectCode`,rule:{required:!0,trigger:["input","blur"],validator(j,d){if(!d)return Error(e("project.node.project_name_tips"))}}}),(_=0)=>{var j,d;return{type:"select",field:"definitionCode",span:24,name:e("project.node.process_name"),props:{filterable:!0,onUpdateValue:async u=>{const T=t.dependTaskList[g].dependItemList[_];T.depTaskCodeOptions=await b(T.projectCode,u),T.depTaskCode=0}},options:((d=(j=t.dependTaskList[g])==null?void 0:j.dependItemList[_])==null?void 0:d.definitionCodeOptions)||[],path:`dependTaskList.${g}.dependItemList.${_}.definitionCode`,rule:{required:!0,trigger:["input","blur"],validator(u,T){if(!T)return Error(e("project.node.process_name_tips"))}}}},(_=0)=>{var j,d;return{type:"select",field:"depTaskCode",span:24,name:e("project.node.task_name"),props:{filterable:!0},options:((d=(j=t.dependTaskList[g])==null?void 0:j.dependItemList[_])==null?void 0:d.depTaskCodeOptions)||[],path:`dependTaskList.${g}.dependItemList.${_}.depTaskCode`,rule:{required:!0,trigger:["input","blur"],validator(u,T){if(!T&&T!==0)return Error(e("project.node.task_name_tips"))}}}},(_=0)=>({type:"select",field:"cycle",span:10,name:e("project.node.cycle_time"),props:{onUpdateValue:j=>{t.dependTaskList[g].dependItemList[_].dateOptions=p[j],t.dependTaskList[g].dependItemList[_].dateValue=null}},options:l,path:`dependTaskList.${g}.dependItemList.${_}.cycle`,rule:{required:!0,trigger:["input","blur"],validator(j,d){if(!d)return Error(e("project.node.cycle_time_tips"))}}}),(_=0)=>{var j,d;return{type:"select",field:"dateValue",span:10,name:" ",options:((d=(j=t.dependTaskList[g])==null?void 0:j.dependItemList[_])==null?void 0:d.dateOptions)||[],path:`dependTaskList.${g}.dependItemList.${_}.dateValue`,rule:{trigger:["input","blur"],validator(u,T){if(!T)return Error(e("project.node.date_tips"))}}}},(_=0)=>{var j;return{type:"custom",field:"state",span:2,name:" ",widget:h((j=t.dependTaskList[g])==null?void 0:j.dependItemList[_])}}]}),childrenField:"dependItemList",name:"add_dependency"})]}function ht(t){const{t:e}=v();return[{type:"editor",field:"jobFlowDefineJson",name:e("project.node.emr_flow_define_json"),props:{language:"json"},validate:{trigger:["input","trigger"],required:!0,message:e("project.node.emr_flow_define_json_tips")}},...A({model:t,field:"localParams",isSimple:!0})]}function Et(t){const{t:e}=v();return[{type:"input",field:"noteId",name:e("project.node.zeppelin_note_id"),props:{placeholder:e("project.node.zeppelin_note_id_tips")},validate:{trigger:["input","blur"],required:!0,validator(o,r){if(!r)return new Error(e("project.node.zeppelin_note_id_tips"))}}},{type:"input",field:"paragraphId",name:e("project.node.zeppelin_paragraph_id"),props:{placeholder:e("project.node.zeppelin_paragraph_id_tips")},validate:{trigger:["input","blur"],required:!0,validator(o,r){if(!r)return new Error(e("project.node.zeppelin_paragraph_id_tips"))}}},...A({model:t,field:"localParams",isSimple:!1})]}function kt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({taskType:"FLINK",name:"",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,programType:"SCALA",deployMode:"cluster",initScript:"",rawScript:"",flinkVersion:"<1.10",jobManagerMemory:"1G",taskManagerMemory:"2G",slot:1,taskManager:2,parallelism:1});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!(r!=null&&r.id)),...R(a,t),...D(),H(a),...M(a),...pt(a),I()],model:a}}function wt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({taskType:"SHELL",name:"",flag:"YES",description:"",timeoutFlag:!1,timeoutNotifyStrategy:["WARN"],timeout:30,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,rawScript:""});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!(r!=null&&r.id)),...R(a,t),...D(),H(a),...M(a),...Se(a),I()],model:a}}function Lt({projectCode:t,from:e=0,readonly:o,data:r}){const n=ce().currentRoute.value.params.code,s=k({taskType:"SUB_PROCESS",name:"",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30});let i=[];return e===1&&(i=[O(s,o),x({model:s,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...i,L(),N(),C(),P(),q(s,!(r!=null&&r.id)),...R(s,t),...M(s),Ve({model:s,projectCode:t,from:e,processName:r==null?void 0:r.processName,code:e===1?0:Number(n)}),I()],model:s}}function Nt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({taskType:"PIGEON",name:"",flag:"YES",description:"",timeoutFlag:!1,environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,targetJobName:""});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!(r!=null&&r.id)),...R(a,t),...D(),H(a),...M(a),Ue(),I()],model:a}}function Ct({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({name:"",taskType:"PYTHON",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,rawScript:""});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!a.id),...R(a,t),...D(),H(a),...M(a),...Se(a),I()],model:a}}function Pt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({taskType:"SPARK",name:"",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,programType:"SCALA",sparkVersion:"SPARK2",rawScript:"",deployMode:"local",driverCores:1,driverMemory:"512M",numExecutors:2,executorMemory:"2G",executorCores:2});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!(r!=null&&r.id)),...R(a,t),...D(),H(a),...M(a),...at(a),I()],model:a}}function qt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({taskType:"MR",name:"",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,programType:"SCALA"});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!(r!=null&&r.id)),...R(a,t),...D(),H(a),...M(a),...st(a),I()],model:a}}function Rt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({taskType:"HTTP",name:"",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,httpMethod:"GET",httpCheckCondition:"STATUS_CODE_DEFAULT",httpParams:[],url:"",condition:"",connectTimeout:6e4,socketTimeout:6e4});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!(r!=null&&r.id)),...R(a,t),...D(),H(a),...M(a),...ct(a),I()],model:a}}function It({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({name:"",taskType:"SQL",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,type:"MYSQL",displayRows:10,segmentSeparator:"",sql:"",sqlType:"0",preStatements:[],postStatements:[],udfs:[]});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!a.id),...R(a,t),...D(),H(a),...M(a),...fe(a),...$e(a),...yt(a),I()],model:a}}function Ot({projectCode:t,from:e=0,readonly:o,data:r}){var s,i,m,l;const a=k({name:"",taskType:"PROCEDURE",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,type:(s=r==null?void 0:r.taskParams)!=null&&s.type?(i=r==null?void 0:r.taskParams)==null?void 0:i.type:"MYSQL",datasource:(m=r==null?void 0:r.taskParams)==null?void 0:m.datasource,method:(l=r==null?void 0:r.taskParams)==null?void 0:l.method});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!a.id),...R(a,t),...D(),H(a),...M(a),...fe(a),...Je(a),I()],model:a}}function xt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({taskType:"SQOOP",name:"",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,isCustomTask:!1,hadoopCustomParams:[],sqoopAdvancedParams:[],mapColumnHive:[],mapColumnJava:[],modelType:"import",sourceType:"MYSQL",srcQueryType:"1",srcColumnType:"0",targetType:"HDFS",sourceMysqlType:"MYSQL",targetHdfsDeleteTargetDir:!0,targetHdfsCompressionCodec:"snappy",targetHdfsFileType:"--as-avrodatafile",targetMysqlType:"MYSQL",targetMysqlUpdateMode:"allowinsert",targetHiveCreateTable:!1,targetHiveDropDelimiter:!1,targetHiveOverWrite:!0,concurrency:1});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!(r!=null&&r.id)),...R(a,t),...D(),H(a),...M(a),...vt(a),I()],model:a}}function Dt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({name:"",taskType:"SEATUNNEL",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,deployMode:"client",queue:"default",master:"yarn",masterUrl:"",resourceFiles:[]});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!a.id),...R(a,t),...D(),H(a),...M(a),...gt(a),I()],model:a}}function Mt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({taskType:"SWITCH",name:"",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,rawScript:"",switchResult:{},dependTaskList:[],nextNode:void 0});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!(r!=null&&r.id)),...R(a,t),...D(),H(a),...M(a),...jt(a,t),I()],model:a}}function At({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({taskType:"CONDITIONS",name:"",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",timeout:30,relation:"AND",dependTaskList:[],preTasks:[],successNode:"success",failedNode:"failed"});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!(r!=null&&r.id)),...R(a,t),...D(),...Tt(a),I()],model:a}}function Ht({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({name:"",taskType:"DATAX",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30,customConfig:!1,dsType:"MYSQL",dtType:"MYSQL",preStatements:[],postStatements:[]});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!a.id),...R(a,t),...D(),H(a),...M(a),...bt(a),I()],model:a}}function Ft({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({taskType:"DEPENDENT",name:"",flag:"YES",description:"",timeoutShowFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,relation:"AND",dependTaskList:[],preTasks:[],timeoutNotifyStrategy:[],timeout:30,timeoutFlag:!1,...r});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!(r!=null&&r.id)),...R(a,t),...D(),...St(a),I()],model:a}}function Yt({projectCode:t,from:e=0,readonly:o,data:r,jsonRef:a,updateElements:n}){const{t:s}=v(),i=k({taskType:"DATA_QUALITY",name:"",flag:"YES",description:"",timeoutFlag:!1,timeoutNotifyStrategy:["WARN"],timeout:30,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,ruleId:1,deployMode:"cluster",driverCores:1,driverMemory:"512M",numExecutors:2,executorMemory:"2G",executorCores:2,others:"--conf spark.yarn.maxAppAttempts=1"});let m=[];return e===1&&(m=[O(i,o),x({model:i,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...m,L(),N(),C(),P(),q(i,!(r!=null&&r.id)),...R(i,t),...D(),H(i),...M(i),...rt(i,(l,p)=>{a.value.splice(15,p,...l),n()}),X(),_e(),ge(),je(),be(),Te(),{type:"input",field:"others",name:s("project.node.option_parameters"),props:{type:"textarea",placeholder:s("project.node.option_parameters_tips")}},...A({model:i,field:"localParams",isSimple:!0}),I()],model:i}}function Gt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({name:"",taskType:"EMR",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!a.id),...R(a,t),...D(),H(a),...M(a),...ht(a),I()],model:a}}function Qt({projectCode:t,from:e=0,readonly:o,data:r}){const a=k({name:"",taskType:"ZEPPELIN",flag:"YES",description:"",timeoutFlag:!1,localParams:[],environmentCode:null,failRetryInterval:1,failRetryTimes:0,workerGroup:"default",delayTime:0,timeout:30});let n=[];return e===1&&(n=[O(a,o),x({model:a,projectCode:t,isCreate:!(r!=null&&r.id),from:e,processName:r==null?void 0:r.processName})]),{json:[w(e),...n,L(),N(),C(),P(),q(a,!a.id),...R(a,t),...D(),H(a),...M(a),...Et(a),I()],model:a}}var Vt={SHELL:wt,SUB_PROCESS:Lt,PYTHON:Ct,SPARK:Pt,MR:qt,FLINK:kt,HTTP:Rt,PIGEON:Nt,SQL:It,PROCEDURE:Ot,SQOOP:xt,SEATUNNEL:Dt,SWITCH:Mt,CONDITIONS:At,DATAX:Ht,DEPENDENT:Ft,DATA_QUALITY:Yt,EMR:Gt,ZEPPELIN:Qt};function Ut({data:t,projectCode:e,from:o,readonly:r,definition:a}){const n=U();n.updateDefinition(te(a),t==null?void 0:t.code);const s=c([]),i=c([]),m=c({}),l={projectCode:e,from:o,readonly:r,data:t,jsonRef:s,updateElements:()=>{y()}},{model:p,json:f}=Vt[t.taskType||"SHELL"](l);s.value=f,p.preTasks=n.getPreTasks,p.name=n.getName;const y=()=>{const{rules:b,elements:h}=Ee(s.value,p);i.value=h,m.value=b};return y(),{elementsRef:i,rulesRef:m,model:p}}const ea=Le({name:"NodeDetail",emits:["taskTypeChange"],setup(t,{expose:e,emit:o}){const r=U(),a=c(),n=Ce("data")||{projectCode:0,data:{taskType:"SHELL"},readonly:!1,from:0},{data:s,projectCode:i,from:m,readonly:l,definition:p}=te(n),{elementsRef:f,rulesRef:y,model:b}=Ut({data:s,projectCode:i,from:m,readonly:l,definition:p});return Y(()=>b.taskType,async h=>{r.updateName(b.name||""),o("taskTypeChange",h)}),e(a),()=>Ne(ke,{ref:a,meta:{model:b,rules:y.value,elements:f.value,disabled:te(l)},layout:{xGap:10}},null)}});export{ea as default};

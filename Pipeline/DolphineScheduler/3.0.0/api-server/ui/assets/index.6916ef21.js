import{C as v}from"./index.97f03277.js";import{d as N,u as C,a as l,o as A,w as O,c as a,_ as j,bl as _}from"./index.c5429249.js";import w from"./use-tree.3812d0ce.js";import{m as E}from"./index.cc06751b.js";import{l as b}from"./lodash.084a01e7.js";import{t as I}from"./common.145f2eef.js";import{A as P}from"./ArrowLeftOutlined.6d21910b.js";import{N as R}from"./Image.f79a9674.js";import{N as $}from"./Button.c43a24dc.js";import{N as G}from"./Icon.8e3bf5ec.js";import{N as H}from"./FormItem.51e71cc3.js";import{a as x}from"./Select.e833ee40.js";import{N as L}from"./Space.e50db48f.js";import"./Card.c707a1eb.js";import"./use-rtl.c78ffbd8.js";import"./resolve-slot.7c241306.js";import"./index.16077d24.js";import"./keysOf.963e6f6c.js";import"./index.0a49dc37.js";import"./Grid.b73d23e7.js";import"./utils.3eee947a.js";import"./is-browser.d3e5def6.js";import"./VResizeObserver.14b04bb7.js";import"./flatten.a7868693.js";import"./get-slot.c85d6606.js";import"./next-frame-once.da993024.js";import"./service.0215c8a4.js";import"./SettingOutlined.716a0298.js";import"./PauseCircleOutlined.813adbbb.js";import"./CloseCircleOutlined.46c86330.js";import"./CheckCircleOutlined.6daee0ce.js";import"./EditOutlined.af3970b8.js";import"./ClockCircleOutlined.6c97131a.js";import"./index.a2051d72.js";import"./fade-in.cssr.9da325c6.js";import"./fade-in-scale-up.cssr.05526022.js";import"./use-locale.be539345.js";import"./Scrollbar.12b40993.js";import"./index.3e01cddc.js";import"./Tooltip.d759bd4b.js";import"./Popover.df2981b4.js";import"./format-length.e7c2072e.js";import"./use-compitable.b0459e69.js";import"./Selection.a106a9c5.js";import"./Suffix.9ee1fead.js";const U="_content_oganr_17",B="_card_oganr_20",M="_header_oganr_23",V="_right_oganr_29";var m={content:U,card:B,header:M,right:V};function z(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!j(o)}var Gt=N({name:"WorkflowDefinitionTiming",setup(){const o=_(),{t:r,locale:u}=C(),g=l([{label:"25",value:25},{label:"50",value:50},{label:"75",value:75},{label:"100",value:100}]),c=l(Number(o.currentRoute.value.params.projectCode)),n=l(Number(o.currentRoute.value.params.definitionCode)),p=l([]),i=l(),d=l([{taskType:"SHELL",color:"#646464",image:"/dolphinscheduler/ui/images/task-icons/shell.png"},{taskType:"SUB_PROCESS",color:"#4295DA",image:"/dolphinscheduler/ui/images/task-icons/sub_process.png"},{taskType:"PROCEDURE",color:"#545CC6",image:"/dolphinscheduler/ui/images/task-icons/procedure.png"},{taskType:"SQL",color:"#8097A0",image:"/dolphinscheduler/ui/images/task-icons/sql.png"},{taskType:"SPARK",color:"#a16435",image:"/dolphinscheduler/ui/images/task-icons/spark.png"},{taskType:"FLINK",color:"#d68f5b",image:"/dolphinscheduler/ui/images/task-icons/flink.png"},{taskType:"MR",color:"#A1A5C9",image:"/dolphinscheduler/ui/images/task-icons/mr.png"},{taskType:"PYTHON",color:"#60BCD5",image:"/dolphinscheduler/ui/images/task-icons/python.png"},{taskType:"DEPENDENT",color:"#60BCD5",image:"/dolphinscheduler/ui/images/task-icons/dependent.png"},{taskType:"HTTP",color:"#7f3903",image:"/dolphinscheduler/ui/images/task-icons/http.png"},{taskType:"DATAX",color:"#75CC71",image:"/dolphinscheduler/ui/images/task-icons/datax.png"},{taskType:"PIGEON",color:"#5EC459",image:"/dolphinscheduler/ui/images/task-icons/pigeon.png"},{taskType:"SQOOP",color:"#f98b3d",image:"/dolphinscheduler/ui/images/task-icons/sqoop.png"},{taskType:"CONDITIONS",color:"#b99376",image:"/dolphinscheduler/ui/images/task-icons/conditions.png"},{taskType:"SWITCH",color:"#ff6f00",image:"/dolphinscheduler/ui/images/task-icons/switch.png"},{taskType:"SEATUNNEL",color:"#8c8c8f",image:"/dolphinscheduler/ui/images/task-icons/seatunnel.png"},{taskType:"DAG",color:"#bbdde9"}]),D=()=>{i.value=Object.entries(I(r)).map(([t,e])=>({state:t,value:e.desc,color:e.color}))},f=(t,e)=>{e.children=[],t==null||t.children.map(s=>{const T={};f(s,T),e.children.push(T)}),e.name=t.name,e.value=t.name==="DAG"?"DAG":t==null?void 0:t.type;const h=b.exports.find(d.value,{taskType:e.value});if(h&&(e.itemStyle={color:h.color},e.name!=="DAG")){let s=null;t.instances&&t.instances.length>0&&t.instances[0].state&&(s=b.exports.find(i.value,{state:t.instances[0].state})),e.label={show:!0,formatter:[`{name|${r("project.task.task_name")}:${e.name}}`,`{type|${r("project.task.task_type")}:${h.taskType}}`,s?`{state|${r("project.workflow.task_state")}: ${s.value}}`:""].join(`
`),rich:{type:{lineHeight:20,align:"left"},name:{lineHeight:20,align:"left"},state:{lineHeight:20,align:"left",color:s?s.color:"black"}}}}},k=async t=>{if(c.value&&n){const e=await E(c.value,n.value,{limit:t});p.value=[{name:"DAG",value:"DAG"}],f(e,p.value[0])}},S=t=>{t&&k(t)},y=()=>{D(),k(25)};return A(()=>{y()}),O(()=>u.value,()=>{y()}),{chartData:p,options:g,onSelectChange:S,taskTypeNodeOptions:d}},render(){let o;const{chartData:r,options:u,onSelectChange:g,taskTypeNodeOptions:c}=this,{t:n}=C(),p=_();return a("div",{class:m.content},[a(v,{class:m.card},{default:()=>[a("div",{class:m.header},[a($,{type:"primary",onClick:()=>p.go(-1)},{default:()=>[a(G,null,{default:()=>[a(P,null,null)]})]}),a(H,{size:"small",class:m.right,showFeedback:!1,labelPlacement:"left",label:n("project.workflow.tree_limit")},{default:()=>[a(x,{size:"small",defaultValue:25,onUpdateValue:g,options:u},null)]})])]}),a(v,{title:n("project.workflow.tree_view")},{default:()=>[a(L,{align:"center"},z(o=c.filter(i=>i.image).map((i,d)=>a($,{text:!0,size:"tiny",color:i.color},{default:()=>[a(R,{width:"20",src:i.image},null),i.taskType]})))?o:{default:()=>[o]}),a(w,{chartData:r},null)]})])}});export{Gt as default};

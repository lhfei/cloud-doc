import{u as k,r as B,a as m,h as n,bl as P,d as F,w as T,o as M,t as O,c as t,_ as V,B as z}from"./index.c5429249.js";import{C}from"./index.97f03277.js";import I from"./folder-modal.bface060.js";import W from"./upload-modal.c359e679.js";import{b as q}from"./common.145f2eef.js";import{u as D}from"./file.0dabb2be.js";import{u as E}from"./index.075b615e.js";import{q as j,b as x,f as $,e as A}from"./index.8259a597.js";import{B as G}from"./index.3b9f9e63.js";import{D as H,C as u,c as X}from"./column-width-config.63466f21.js";import{E as J}from"./EditOutlined.af3970b8.js";import{D as K}from"./DownloadOutlined.8c21680b.js";import{D as Q}from"./DeleteOutlined.e68b06d7.js";import{a as Y}from"./Dropdown.749e9383.js";import{N as S}from"./Tooltip.d759bd4b.js";import{N as f}from"./Button.c43a24dc.js";import{N as Z}from"./Popconfirm.83d41c5f.js";import{N as R}from"./Space.e50db48f.js";import{S as ee}from"./SearchOutlined.5b629110.js";import{N as te}from"./Icon.8e3bf5ec.js";import{N as ae}from"./Input.97d5419b.js";import{N as re,a as oe}from"./DataTable.d85b2298.js";import{N as ie,a as U}from"./BreadcrumbItem.10fc7694.js";import"./Card.c707a1eb.js";import"./use-rtl.c78ffbd8.js";import"./resolve-slot.7c241306.js";import"./index.16077d24.js";import"./keysOf.963e6f6c.js";import"./index.20e11ec3.js";import"./index.3e01cddc.js";import"./flatten.a7868693.js";import"./Scrollbar.12b40993.js";import"./fade-in.cssr.9da325c6.js";import"./VResizeObserver.14b04bb7.js";import"./fade-in-scale-up.cssr.05526022.js";import"./utils.3eee947a.js";import"./is-browser.d3e5def6.js";import"./trim.f84c3e44.js";import"./use-modal.3238aac7.js";import"./Form.13999875.js";import"./FormItem.51e71cc3.js";import"./format-length.e7c2072e.js";import"./CloudUploadOutlined.2cbd7c1d.js";import"./Upload.6ed710a6.js";import"./Add.e846b00c.js";import"./Image.f79a9674.js";import"./use-locale.be539345.js";import"./next-frame-once.da993024.js";import"./lodash.084a01e7.js";import"./SettingOutlined.716a0298.js";import"./PauseCircleOutlined.813adbbb.js";import"./CloseCircleOutlined.46c86330.js";import"./CheckCircleOutlined.6daee0ce.js";import"./ClockCircleOutlined.6c97131a.js";import"./index.a2051d72.js";import"./service.0215c8a4.js";import"./Popover.df2981b4.js";import"./use-compitable.b0459e69.js";import"./ChevronRight.f70a9c2d.js";import"./Selection.a106a9c5.js";import"./Suffix.9ee1fead.js";import"./use-keyboard.22724d1e.js";import"./get-slot.c85d6606.js";import"./ArrowDown.db19052e.js";import"./Checkbox.7506e5f5.js";import"./RadioGroup.47f9a37a.js";import"./Radio.5a2a0c2a.js";import"./Select.e833ee40.js";import"./Forward.23552619.js";const se=(e,i)=>{const l=D();l.setFileInfo(`${i.alias}|${i.size}`),i.directory&&(l.setCurrentDir(`${i.fullName}`),e.push({name:"resource-sub-manage",params:{id:i.id}}))};function le(){const{t:e}=k(),i=P(),l=D(),r=B({columns:[],tableWidth:H,row:{},tableData:[],breadList:[],id:m(Number(i.currentRoute.value.params.id)||-1),page:m(1),pageSize:m(10),searchVal:m(),totalPage:m(1),folderShowRef:m(!1),uploadShowRef:m(!1),loadingRef:m(!1)}),o=s=>{s.columns=[{title:"#",key:"id",...u.index,render:(a,c)=>c+1},{title:e("resource.udf.udf_source_name"),key:"alias",...u.linkName,render:a=>a.directory?n(G,{onClick:()=>void se(i,a)},{default:()=>n(Y,u.linkEllipsis,()=>a.alias)}):a.alias},{title:e("resource.udf.user_name"),...u.userName,key:"userName"},{title:e("resource.udf.whether_directory"),key:"whether_directory",...u.yesOrNo,render:a=>a.directory?e("resource.file.yes"):e("resource.file.no")},{title:e("resource.udf.file_name"),...u.name,key:"fileName"},{title:e("resource.udf.file_size"),key:"size",...u.size,render:a=>q(a.size)},{title:e("resource.udf.description"),key:"description",...u.note},{title:e("resource.udf.create_time"),key:"createTime",...u.time},{title:e("resource.udf.update_time"),key:"updateTime",...u.time},{title:e("resource.udf.operation"),key:"operation",...u.operation(3),render:a=>n(R,null,{default:()=>[n(S,{},{trigger:()=>n(f,{tag:"div",circle:!0,type:"info",size:"tiny",class:"btn-edit",onClick:()=>{h(a)}},{icon:()=>n(J)}),default:()=>e("resource.udf.edit")}),n(S,{},{trigger:()=>n(f,{tag:"div",circle:!0,type:"info",size:"tiny",class:"btn-download",disabled:!!(a!=null&&a.directory),onClick:()=>$(a.id)},{icon:()=>n(K)}),default:()=>e("resource.udf.download")}),n(Z,{onPositiveClick:()=>{y(a.id)}},{trigger:()=>n(S,{},{trigger:()=>n(f,{tag:"div",circle:!0,type:"error",size:"tiny",class:"btn-delete"},{icon:()=>n(Q)}),default:()=>e("resource.udf.delete")}),default:()=>e("resource.udf.delete_confirm")})]})}],s.tableWidth&&(s.tableWidth=X(s.columns))},d=s=>{if(r.loadingRef)return;r.loadingRef=!0;const{state:a}=E(j({...s,type:"UDF"}).then(c=>{const g=r.id===-1?[]:l.getCurrentDir.split("/");g.shift(),r.breadList=g,r.totalPage=c.totalPage,r.tableData=c.totalList.map(_=>({..._})),r.loadingRef=!1}),{total:0,table:[]});return a},h=s=>{r.folderShowRef=!0,r.row=s},y=s=>{r.tableData.length===1&&r.page>1&&(r.page-=1),A(s).then(()=>d({id:r.id,pageSize:r.pageSize,pageNo:r.page,searchVal:r.searchVal}))};return{variables:r,createColumns:o,getTableData:d,goUdfManage:()=>{i.push({name:"resource-manage"})},goBread:s=>{const{id:a}=r;x({id:a,type:"UDF",fullName:s},a).then(c=>{l.setCurrentDir(c.fullName),i.push({name:"resource-sub-manage",params:{id:c.id}})})}}}const ne="_content_el425_17",de="_card_el425_20",ue="_header_el425_23",ce="_right_el425_29",pe="_search_el425_29",me="_list_el425_29",fe="_table_el425_33",he="_pagination_el425_53";var p={content:ne,card:de,header:ue,right:ce,search:pe,list:me,table:fe,pagination:he};function b(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!V(e)}var Bt=F({name:"resource-manage",setup(){const{variables:e,createColumns:i,getTableData:l,goUdfManage:r,goBread:o}=le(),d=()=>{l({id:e.id,pageSize:e.pageSize,pageNo:e.page,searchVal:e.searchVal})},h=()=>{d()},y=()=>{e.page=1,d()},w=()=>{e.page=1,d()},N=g=>{g.value=!0},s=()=>{e.row={},N(z(e,"folderShowRef"))},a=()=>{N(z(e,"uploadShowRef"))},c=g=>{let _="";e.breadList.forEach((v,L)=>{L<=g&&(_=_+"/"+v)}),o(_)};return T(k().locale,()=>{i(e)}),M(()=>{i(e),d()}),{goUdfManage:r,handleBread:c,requestData:d,handleSearch:w,handleUpdateList:h,handleCreateFolder:s,handleUploadFile:a,handleChangePageSize:y,...O(e)}},render(){let e,i;const{t:l}=k(),{loadingRef:r}=this;return t("div",{class:p.content},[t(C,{class:p.card},{default:()=>[t("div",{class:p.header},[t(R,null,{default:()=>[t(f,{type:"primary",onClick:this.handleCreateFolder,class:"btn-create-directory"},b(e=l("resource.udf.create_folder"))?e:{default:()=>[e]}),t(f,{strong:!0,secondary:!0,onClick:this.handleUploadFile,class:"btn-upload-udf"},b(i=l("resource.udf.upload_udf_resources"))?i:{default:()=>[i]})]}),t("div",{class:p.right},[t("div",{class:p.search},[t("div",{class:p.list},[t(f,{type:"primary",onClick:this.handleSearch},{default:()=>[t(te,null,{default:()=>[t(ee,null,null)]})]})]),t("div",{class:p.list},[t(ae,{placeholder:l("resource.udf.enter_keyword_tips"),value:this.searchVal,"onUpdate:value":o=>this.searchVal=o},null)])])])])]}),t(C,{title:l("resource.udf.udf_resources")},{default:()=>t("div",null,[t(re,{loading:r,columns:this.columns,data:this.tableData,striped:!0,size:"small",class:p.table,"row-class-name":"items",scrollX:this.tableWidth},null),t("div",{class:p.pagination},[t(oe,{page:this.page,"onUpdate:page":o=>this.page=o,"page-size":this.pageSize,"onUpdate:page-size":o=>this.pageSize=o,"page-count":this.totalPage,"show-size-picker":!0,"page-sizes":[10,30,50],"show-quick-jumper":!0,onUpdatePage:this.requestData,onUpdatePageSize:this.handleChangePageSize},null)])]),header:()=>{let o;return t(ie,{separator:">"},{default:()=>[t(U,null,{default:()=>[t(f,{text:!0,onClick:()=>this.goUdfManage()},b(o=l("resource.udf.udf_resources"))?o:{default:()=>[o]})]}),this.breadList.map((d,h)=>t(U,null,{default:()=>[t(f,{text:!0,disabled:h===this.breadList.length-1,onClick:()=>this.handleBread(h)},b(d)?d:{default:()=>[d]})]}))]})}}),t(I,{row:this.row,"onUpdate:row":o=>this.row=o,show:this.folderShowRef,"onUpdate:show":o=>this.folderShowRef=o,onUpdateList:this.handleUpdateList},null),t(W,{show:this.uploadShowRef,"onUpdate:show":o=>this.uploadShowRef=o,onUpdateList:this.handleUpdateList},null)])}});export{Bt as default};

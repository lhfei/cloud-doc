import{C as D}from"./index.97f03277.js";import{u as v,h as C,r as N,a as l,d as G,o as w,t as U,c as t,bl as M}from"./index.c5429249.js";import{d as L,a as z}from"./index.bbd47aff.js";import O from"./table-action.a6f394c8.js";import{_ as H}from"./lodash.084a01e7.js";import{C as p,c as Q,D as W}from"./column-width-config.63466f21.js";import{p as I}from"./common.145f2eef.js";import{f as P}from"./index.a2051d72.js";import x from"./form-modal.dde48a4f.js";import{S as j}from"./SearchOutlined.5b629110.js";import{N as B}from"./Card.c707a1eb.js";import{N as F}from"./Space.e50db48f.js";import{a as A}from"./Select.e833ee40.js";import{N as q}from"./Input.97d5419b.js";import{N as V}from"./Button.c43a24dc.js";import{N as X}from"./Icon.8e3bf5ec.js";import{N as E,a as J}from"./DataTable.d85b2298.js";import"./service.0215c8a4.js";import"./EditOutlined.af3970b8.js";import"./PlayCircleOutlined.7616d1e9.js";import"./Tooltip.d759bd4b.js";import"./Popover.df2981b4.js";import"./index.3e01cddc.js";import"./flatten.a7868693.js";import"./Scrollbar.12b40993.js";import"./fade-in.cssr.9da325c6.js";import"./VResizeObserver.14b04bb7.js";import"./format-length.e7c2072e.js";import"./utils.3eee947a.js";import"./resolve-slot.7c241306.js";import"./use-compitable.b0459e69.js";import"./next-frame-once.da993024.js";import"./SettingOutlined.716a0298.js";import"./PauseCircleOutlined.813adbbb.js";import"./CloseCircleOutlined.46c86330.js";import"./CheckCircleOutlined.6daee0ce.js";import"./ClockCircleOutlined.6c97131a.js";import"./index.20e11ec3.js";import"./index.3b9f9e63.js";import"./keysOf.963e6f6c.js";import"./fade-in-scale-up.cssr.05526022.js";import"./is-browser.d3e5def6.js";import"./Form.13999875.js";import"./FormItem.51e71cc3.js";import"./use-rtl.c78ffbd8.js";import"./index.16077d24.js";import"./get-slot.c85d6606.js";import"./use-locale.be539345.js";import"./Selection.a106a9c5.js";import"./Suffix.9ee1fead.js";import"./ArrowDown.db19052e.js";import"./Checkbox.7506e5f5.js";import"./RadioGroup.47f9a37a.js";import"./Radio.5a2a0c2a.js";import"./Dropdown.749e9383.js";import"./ChevronRight.f70a9c2d.js";import"./use-keyboard.22724d1e.js";import"./Forward.23552619.js";const K="_toolbar_1a49y_17",Y="_pagination_1a49y_38";var y={toolbar:K,"table-card":"_table-card_1a49y_24","table-action":"_table-action_1a49y_27",pagination:Y};function T(m=(e,c)=>{},d=()=>{}){const{t:e}=v(),c=[{title:"#",key:"index",render:(n,o)=>o+1,...p.index},{title:e("resource.task_group_queue.project_name"),key:"projectName",...p.name},{title:e("resource.task_group_queue.task_name"),key:"taskName",...p.name},{title:e("resource.task_group_queue.workflow_instance_name"),key:"processInstanceName",...p.name},{title:e("resource.task_group_queue.task_group_name"),key:"taskGroupName",...p.name},{title:e("resource.task_group_queue.priority"),key:"priority",width:120},{title:e("resource.task_group_queue.force_starting_status"),key:"forceStart",...p.state},{title:e("resource.task_group_queue.in_queue"),key:"inQueue",width:120},{title:e("resource.task_group_queue.task_status"),key:"status",...p.state},{title:e("resource.task_group_queue.create_time"),key:"createTime",...p.time},{title:e("resource.task_group_queue.update_time"),key:"updateTime",...p.time},{title:e("resource.task_group_queue.actions"),key:"actions",...p.operation(2),render:n=>C(O,{row:n,onResetTableData:()=>{a.page>1&&a.tableData.length===1&&(a.page-=1),d()},onUpdatePriority:(o,s)=>{m(o,s)}})}],a=N({tableData:[],tableWidth:Q(c)||W,page:l(1),pageSize:l(10),groupId:l(3),totalPage:l(1),loadingRef:l(!1)});return{getTableData:n=>{if(a.loadingRef)return;a.loadingRef=!0;const o={pageNo:1,pageSize:2147483647};Promise.all([L(n),z(o)]).then(s=>{const u=s[1].totalList;a.totalPage=s[0].totalPage,a.tableData=s[0].totalList.map((i,_)=>{let r="";if(u){const f=H.find(u,{id:i.groupId});f&&(r=f.name)}return i.taskGroupName=r,i.createTime=P(I(i.createTime),"yyyy-MM-dd HH:mm:ss"),i.updateTime=P(I(i.updateTime),"yyyy-MM-dd HH:mm:ss"),{...i}})},()=>{}),a.loadingRef=!1},variables:a,columns:c}}const ta=G({name:"taskGroupQueue",setup(){const m=M(),{t:d}=v(),{variables:e,getTableData:c}=T(),a=l(!1),g=l([]),n=l(Number(m.currentRoute.value.params.id)),o=N({groupId:l(),processName:"",instanceName:"",pageSize:10,pageNo:1});let s=N({queueId:0,priority:0});const u=()=>{c({pageSize:e.pageSize,pageNo:e.page,groupId:o.groupId,taskInstanceName:o.instanceName,processInstanceName:o.processName})},i=()=>{a.value=!1},_=()=>{a.value=!1,s={queueId:0,priority:0},u()},r=()=>{e.page=1,u()},f=(k,h)=>{a.value=!0,s.queueId=k,s.priority=h},R=()=>{u()};return w(()=>{const k={pageNo:1,pageSize:2147483647};n.value&&(o.groupId=n.value),z(k).then(h=>{h.totalList.map(b=>{const S={label:b.name,value:b.id};g.value.push(S)})}),u()}),{...U(e),t:d,onSearch:R,searchParamRef:o,resetTableData:u,onUpdatePageSize:r,updatePriority:f,onCancel:i,onConfirm:_,showModalRef:a,updateItemData:s,taskGroupOptions:g}},render(){const{t:m,resetTableData:d,onUpdatePageSize:e,updatePriority:c,onCancel:a,onConfirm:g,onSearch:n,showModalRef:o,updateItemData:s,taskGroupOptions:u,loadingRef:i}=this,{columns:_}=T(c,d);return t("div",null,[t(B,null,{default:()=>[t("div",{class:y.toolbar},[t(F,null,{default:()=>[t(A,{size:"small",options:u,clearable:!0,style:{width:"180px"},value:this.searchParamRef.groupId,"onUpdate:value":r=>this.searchParamRef.groupId=r,placeholder:m("resource.task_group_queue.task_group_name")},null),t(q,{size:"small",value:this.searchParamRef.processName,"onUpdate:value":r=>this.searchParamRef.processName=r,placeholder:m("resource.task_group_queue.workflow_instance_name")},null),t(q,{size:"small",value:this.searchParamRef.instanceName,"onUpdate:value":r=>this.searchParamRef.instanceName=r,placeholder:m("resource.task_group_queue.task_instance_name")},null),t(V,{size:"small",type:"primary",onClick:n},{default:()=>[t(X,null,{default:()=>[t(j,null,null)]})]})]})])]}),t(D,{class:y["table-card"],title:m("resource.task_group_queue.queue")},{default:()=>[t("div",null,[t(E,{loading:i,columns:_,size:"small",data:this.tableData,striped:!0,scrollX:this.tableWidth},null),t("div",{class:y.pagination},[t(J,{page:this.page,"onUpdate:page":r=>this.page=r,"page-size":this.pageSize,"onUpdate:page-size":r=>this.pageSize=r,"page-count":this.totalPage,"show-size-picker":!0,"page-sizes":[10,30,50],"show-quick-jumper":!0,onUpdatePage:d,onUpdatePageSize:e},null)])])]}),o&&t(x,{show:o,onCancel:a,onConfirm:g,data:s},null)])}});export{ta as default};

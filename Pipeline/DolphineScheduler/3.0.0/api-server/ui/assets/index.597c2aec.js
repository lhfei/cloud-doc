import{u,bl as h,X as _,r as b,a as x,d as N,t as y,c as r,_ as C}from"./index.c5429249.js";import{C as R}from"./index.97f03277.js";import{M as g}from"./index.31fbc8bd.js";import{u as w}from"./file.0dabb2be.js";import{o as S}from"./index.8259a597.js";import{f as E}from"./common.145f2eef.js";import{s as f}from"./index.module.9dd9e39b.js";import{N as O}from"./Form.13999875.js";import{N as n}from"./FormItem.51e71cc3.js";import{N as m}from"./Input.97d5419b.js";import{a as j}from"./Select.e833ee40.js";import{N as p}from"./Button.c43a24dc.js";import"./Card.c707a1eb.js";import"./use-rtl.c78ffbd8.js";import"./resolve-slot.7c241306.js";import"./index.16077d24.js";import"./keysOf.963e6f6c.js";import"./service.0215c8a4.js";import"./lodash.084a01e7.js";import"./SettingOutlined.716a0298.js";import"./PauseCircleOutlined.813adbbb.js";import"./CloseCircleOutlined.46c86330.js";import"./CheckCircleOutlined.6daee0ce.js";import"./EditOutlined.af3970b8.js";import"./ClockCircleOutlined.6c97131a.js";import"./index.a2051d72.js";import"./format-length.e7c2072e.js";import"./fade-in.cssr.9da325c6.js";import"./use-locale.be539345.js";import"./Scrollbar.12b40993.js";import"./VResizeObserver.14b04bb7.js";import"./Suffix.9ee1fead.js";import"./fade-in-scale-up.cssr.05526022.js";import"./use-compitable.b0459e69.js";import"./Selection.a106a9c5.js";import"./Popover.df2981b4.js";import"./index.3e01cddc.js";import"./flatten.a7868693.js";import"./utils.3eee947a.js";import"./next-frame-once.da993024.js";import"./is-browser.d3e5def6.js";function I(t){const{t:i}=u(),e=h(),o=w();return{handleCreateFile:()=>{const s=e.currentRoute.value.params.id||-1,l=o.getCurrentDir||"/";t.fileFormRef.validate(async a=>{if(!a){await S({...t.fileForm,pid:s,currentDir:l}),window.$message.success(i("resource.file.success"));const v=s?"resource-file-subdirectory":"file";e.push({name:v,params:{id:s}})}})}}}const c=()=>({pid:-1,type:"FILE",suffix:"sh",fileName:"",description:"",content:"",currentDir:"/"});function U(){const{t}=u(),i=()=>{e.fileForm=Object.assign(_(e.fileForm),c())},e=b({fileFormRef:x(),fileForm:c(),rules:{fileName:{required:!0,trigger:["input","blur"],validator(){if(e.fileForm.fileName==="")return new Error(t("resource.file.enter_name_tips"));if(e.fileForm.fileName.endsWith(`.${e.fileForm.suffix}`))return new Error(t("resource.file.duplicate_suffix_tips"))}},suffix:{required:!0,trigger:["input","blur"],validator(){if(e.fileForm.suffix==="")return new Error(t("resource.file.enter_suffix_tips"))}},content:{required:!0,trigger:["input","blur"],validator(){if(e.fileForm.content==="")return new Error(t("resource.file.enter_content_tips"))}}}});return{state:e,resetForm:i}}function d(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!C(t)}var xe=N({name:"ResourceFileCreate",setup(){const t=h(),{state:i}=U(),{handleCreateFile:e}=I(i);return{fileSuffixOptions:E.map(l=>({key:l,label:l,value:l})),handleFile:()=>{e()},handleReturn:()=>{const{id:l}=t.currentRoute.value.params,a=l?"resource-file-subdirectory":"file";t.push({name:a,params:{id:l}})},...y(i)}},render(){let t,i;const{t:e}=u();return r(R,{title:e("resource.file.file_details")},{default:()=>[r(O,{rules:this.rules,ref:"fileFormRef",class:f["form-content"]},{default:()=>[r(n,{label:e("resource.file.file_name"),path:"fileName"},{default:()=>[r(m,{value:this.fileForm.fileName,"onUpdate:value":o=>this.fileForm.fileName=o,placeholder:e("resource.file.enter_name_tips"),style:{width:"300px"},class:"input-file-name"},null)]}),r(n,{label:e("resource.file.file_format"),path:"suffix"},{default:()=>[r(j,{defaultValue:[this.fileForm.suffix],value:this.fileForm.suffix,"onUpdate:value":o=>this.fileForm.suffix=o,options:this.fileSuffixOptions,style:{width:"100px"},class:"select-file-format"},null)]}),r(n,{label:e("resource.file.description"),path:"description"},{default:()=>[r(m,{type:"textarea",value:this.fileForm.description,"onUpdate:value":o=>this.fileForm.description=o,placeholder:e("resource.file.enter_description_tips"),style:{width:"430px"},class:"input-description"},null)]}),r(n,{label:e("resource.file.file_content"),path:"content"},{default:()=>[r("div",{style:{width:"90%"}},[r(g,{value:this.fileForm.content,"onUpdate:value":o=>this.fileForm.content=o},null)])]}),r("div",{class:f["file-edit-content"]},[r("div",{class:f.submit},[r(p,{type:"info",size:"small",round:!0,onClick:this.handleFile,class:"btn-submit"},d(t=e("resource.file.save"))?t:{default:()=>[t]}),r(p,{type:"info",size:"small",text:!0,style:{marginLeft:"15px"},onClick:this.handleReturn,class:"btn-cancel"},d(i=e("resource.file.return"))?i:{default:()=>[i]})])])]})]})}});export{xe as default};

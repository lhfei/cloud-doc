import{d as me,h as v,bD as Vn,aE as Hn,bN as Kn,aD as qn,aG as Wn,k as Cn,n as Ee,a3 as Xn,a4 as Yn,N as Gn,a as D,aH as sn,j as T,o as Jn,R as le,a7 as Qn,aw as Zn,q as P,p as de,v as $,bK as bn,x as ye,y as _e,a8 as cn,z as Nn,A as Ye,J as Ue,B as A,w as We,C as Tn,D as Dn,H as kn,E as et,T as nt,F as tt}from"./index.c5429249.js";import{a as lt}from"./Checkbox.7506e5f5.js";import{h as un,c as Fn,a as at,V as rt,N as Pn,f as xn,u as ot,b as it,F as dt}from"./Selection.a106a9c5.js";import{i as st}from"./is-browser.d3e5def6.js";import{p as ct,g as ut}from"./index.16077d24.js";import{u as we,X as pn}from"./Scrollbar.12b40993.js";import{r as An,c as B,a as ft}from"./resolve-slot.7c241306.js";import{f as ht,m as gt}from"./fade-in-scale-up.cssr.05526022.js";import{u as vt}from"./use-locale.be539345.js";import{u as yt}from"./Button.c43a24dc.js";import{c as mt}from"./index.3e01cddc.js";import{u as fn,V as bt,a as kt,b as xt}from"./Popover.df2981b4.js";function Ln(e){return typeof e=="string"?`s-${e}`:`n-${e}`}var pt=me({name:"Switcher",render(){return v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},v("path",{d:"M12 8l10 8l-10 8z"}))}});const wt=e=>{const{popoverColor:t,boxShadow2:r,borderRadius:u,heightMedium:o,dividerColor:f,textColor2:k}=e;return{menuPadding:"4px",menuColor:t,menuBoxShadow:r,menuBorderRadius:u,menuHeight:`calc(${o} * 7.6)`,actionDividerColor:f,actionTextColor:k,actionPadding:"8px 12px"}},St=Vn({name:"TreeSelect",common:Hn,peers:{Tree:Kn,Empty:qn,InternalSelection:Wn},self:wt});var Rt=St;const hn=Cn("n-tree-select"),Me=Cn("n-tree");var Kt=me({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},expanded:Boolean,hide:Boolean,loading:Boolean,onClick:Function},setup(e){const{renderSwitcherIconRef:t}=Ee(Me,null);return()=>{const{clsPrefix:r}=e;return v("span",{"data-switcher":!0,class:[`${r}-tree-node-switcher`,{[`${r}-tree-node-switcher--expanded`]:e.expanded,[`${r}-tree-node-switcher--hide`]:e.hide}],onClick:e.onClick},v("div",{class:`${r}-tree-node-switcher__icon`},v(Xn,null,{default:()=>{if(e.loading)return v(Yn,{clsPrefix:r,key:"loading",radius:85,strokeWidth:20});const{value:u}=t;return u?u():v(Gn,{clsPrefix:r,key:"switcher"},{default:()=>v(pt,null)})}})))}}}),Ct=me({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const t=Ee(Me);function r(o){const{onCheck:f}=e;if(f)return f(o)}function u(o){e.indeterminate?r(!1):r(o)}return{handleUpdateValue:u,mergedTheme:t.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:t,checked:r,indeterminate:u,disabled:o,focusable:f,handleUpdateValue:k}=this;return v("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],"data-checkbox":!0},v(lt,{focusable:f,disabled:o,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:r,indeterminate:u,onUpdateChecked:k}))}}),Nt=me({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:r,renderSuffixRef:u,labelFieldRef:o}=Ee(Me),f=D(null);function k(K){const{onClick:g}=e;g&&g(K)}function m(K){k(K)}return{selfRef:f,renderLabel:t,renderPrefix:r,renderSuffix:u,labelField:o,handleClick:m}},render(){const{clsPrefix:e,labelField:t,nodeProps:r,checked:u=!1,selected:o=!1,renderLabel:f,renderPrefix:k,renderSuffix:m,handleClick:K,onDragstart:g,tmNode:{rawNode:b,rawNode:{prefix:y,suffix:h,[t]:S}}}=this;return v("span",Object.assign({},r,{ref:"selfRef",class:[`${e}-tree-node-content`,r==null?void 0:r.class],onClick:K,draggable:g===void 0?void 0:!0,onDragstart:g}),k||y?v("div",{class:`${e}-tree-node-content__prefix`},k?k({option:b,selected:o,checked:u}):sn(y)):null,v("div",{class:`${e}-tree-node-content__text`},f?f({option:b,selected:o,checked:u}):sn(S)),m||h?v("div",{class:`${e}-tree-node-content__suffix`},m?m({option:b,selected:o,checked:u}):sn(h)):null)}});function wn({position:e,offsetLevel:t,indent:r,el:u}){const o={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")o.left=0,o.top=0,o.bottom=0,o.borderRadius="inherit",o.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const f=e==="before"?"top":"bottom";o[f]=0,o.left=`${u.offsetLeft+6-t*r}px`,o.height="2px",o.backgroundColor="var(--n-drop-mark-color)",o.transformOrigin=f,o.borderRadius="1px",o.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return v("div",{style:o})}function Tt({dropPosition:e,node:t}){return t.isLeaf===!1||t.children?!0:e!=="inside"}const Dt=me({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=Ee(Me),{droppingNodeParentRef:r,droppingMouseNodeRef:u,draggingNodeRef:o,droppingPositionRef:f,droppingOffsetLevelRef:k,nodePropsRef:m,indentRef:K,blockLineRef:g,checkboxPlacementRef:b}=t,y=T(()=>t.disabledRef.value||e.tmNode.disabled),h=T(()=>{const{value:i}=m;if(!!i)return i({option:e.tmNode.rawNode})}),S=D(null),R={value:null};Jn(()=>{R.value=S.value.$el});function _(){const{tmNode:i}=e;if(!i.isLeaf&&!i.shallowLoaded){if(!t.loadingKeysRef.value.has(i.key))t.loadingKeysRef.value.add(i.key);else return;const{onLoadRef:{value:N}}=t;N&&N(i.rawNode).then(()=>{t.handleSwitcherClick(i)}).finally(()=>{t.loadingKeysRef.value.delete(i.key)})}else t.handleSwitcherClick(i)}const U=le(()=>!e.tmNode.disabled&&t.selectableRef.value&&(t.internalTreeSelect?t.mergedCheckStrategyRef.value!=="child"||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf:!0));function C(i){const{value:N}=t.expandOnClickRef,{value:L}=U;if(!L&&!N||un(i,"checkbox")||un(i,"switcher"))return;const{tmNode:ce}=e;L&&t.handleSelect(ce),N&&!ce.isLeaf&&_()}function E(i){var N,L;g.value||(y.value||C(i),(L=(N=h.value)===null||N===void 0?void 0:N.onClick)===null||L===void 0||L.call(N,i))}function O(i){var N,L;!g.value||(y.value||C(i),(L=(N=h.value)===null||N===void 0?void 0:N.onClick)===null||L===void 0||L.call(N,i))}function j(i){t.handleCheck(e.tmNode,i)}function V(i){t.handleDragStart({event:i,node:e.tmNode})}function ae(i){i.currentTarget===i.target&&t.handleDragEnter({event:i,node:e.tmNode})}function se(i){i.preventDefault(),t.handleDragOver({event:i,node:e.tmNode})}function J(i){t.handleDragEnd({event:i,node:e.tmNode})}function re(i){i.currentTarget===i.target&&t.handleDragLeave({event:i,node:e.tmNode})}function Se(i){i.preventDefault(),f.value!==null&&t.handleDrop({event:i,node:e.tmNode,dropPosition:f.value})}return{showDropMark:le(()=>{const{value:i}=o;if(!i)return;const{value:N}=f;if(!N)return;const{value:L}=u;if(!L)return;const{tmNode:ce}=e;return ce.key===L.key}),showDropMarkAsParent:le(()=>{const{value:i}=r;if(!i)return!1;const{tmNode:N}=e,{value:L}=f;return L==="before"||L==="after"?i.key===N.key:!1}),pending:le(()=>t.pendingNodeKeyRef.value===e.tmNode.key),loading:le(()=>t.loadingKeysRef.value.has(e.tmNode.key)),highlight:le(()=>{var i;return(i=t.highlightKeySetRef.value)===null||i===void 0?void 0:i.has(e.tmNode.key)}),checked:le(()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key)),indeterminate:le(()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:le(()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:le(()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:y,checkable:T(()=>t.checkableRef.value&&(t.cascadeRef.value||t.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),checkboxDisabled:T(()=>!!e.tmNode.rawNode.checkboxDisabled),selectable:U,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:g,nodeProps:h,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:f,droppingOffsetLevel:k,indent:K,checkboxPlacement:b,contentInstRef:S,contentElRef:R,handleCheck:j,handleDrop:Se,handleDragStart:V,handleDragEnter:ae,handleDragOver:se,handleDragEnd:J,handleDragLeave:re,handleLineClick:O,handleContentClick:E,handleSwitcherClick:_}},render(){const{tmNode:e,clsPrefix:t,checkable:r,expandOnClick:u,selectable:o,selected:f,checked:k,highlight:m,draggable:K,blockLine:g,indent:b,disabled:y,pending:h,internalScrollable:S,nodeProps:R,checkboxPlacement:_}=this,U=K&&!y?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,C=S?Ln(e.key):void 0,E=_==="right",O=r?v(Ct,{right:E,focusable:this.checkboxFocusable,disabled:y||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return v("div",Object.assign({class:`${t}-tree-node-wrapper`},U),v("div",Object.assign({},g?R:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:f,[`${t}-tree-node--checkable`]:r,[`${t}-tree-node--highlight`]:m,[`${t}-tree-node--pending`]:h,[`${t}-tree-node--disabled`]:y,[`${t}-tree-node--selectable`]:o,[`${t}-tree-node--clickable`]:o||u},R==null?void 0:R.class],"data-key":C,draggable:K&&g,onClick:this.handleLineClick,onDragstart:K&&g&&!y?this.handleDragStart:void 0}),Qn(e.level,v("div",{class:`${t}-tree-node-indent`},v("div",{style:{width:`${b}px`}}))),v(Kt,{clsPrefix:t,expanded:this.expanded,loading:this.loading,hide:e.isLeaf,onClick:this.handleSwitcherClick}),E?null:O,v(Nt,{ref:"contentInstRef",clsPrefix:t,checked:k,selected:f,onClick:this.handleContentClick,nodeProps:g?void 0:R,onDragstart:K&&!g&&!y?this.handleDragStart:void 0,tmNode:e}),K?this.showDropMark?wn({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:b}):this.showDropMarkAsParent?wn({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:b}):null:null,E?O:null))}});var En=Dt;function On(e,t,r,u){e==null||e.forEach(o=>{r(o),On(o[t],t,r,u),u(o)})}function Ft(e,t,r,u,o){const f=new Set,k=new Set,m=[];return On(e,u,K=>{if(m.push(K),o(t,K)){k.add(K[r]);for(let g=m.length-2;g>=0;--g)if(!f.has(m[g][r]))f.add(m[g][r]);else return}},()=>{m.pop()}),{expandedKeys:Array.from(f),highlightKeySet:k}}if(st&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function Pt(e,t,r,u,o){const f=new Set,k=new Set,m=new Set,K=[],g=[],b=[];function y(S){S.forEach(R=>{if(b.push(R),t(r,R)){f.add(R[u]),m.add(R[u]);for(let U=b.length-2;U>=0;--U){const C=b[U][u];if(!k.has(C))k.add(C),f.has(C)&&f.delete(C);else break}}const _=R[o];_&&y(_),b.pop()})}y(e);function h(S,R){S.forEach(_=>{const U=_[u],C=f.has(U),E=k.has(U);if(!C&&!E)return;const O=_[o];if(O)if(C)R.push(_);else{K.push(U);const j=Object.assign(Object.assign({},_),{[o]:[]});R.push(j),h(O,j[o])}else R.push(_)})}return h(e,g),{filteredTree:g,highlightKeySet:m,expandedKeys:K}}function At({fNodesRef:e,mergedExpandedKeysRef:t,mergedSelectedKeysRef:r,handleSelect:u,handleSwitcherClick:o}){const{value:f}=r,k=Ee(hn,null),m=k?k.pendingNodeKeyRef:D(f.length?f[f.length-1]:null);function K(g){const{value:b}=m;if(b===null){if((g.key==="ArrowDown"||g.key==="ArrowUp")&&g.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(g.key)&&b===null){const{value:y}=e;let h=0;for(;h<y.length;){if(!y[h].disabled){m.value=y[h].key;break}h+=1}}}else{const{value:y}=e;let h=y.findIndex(S=>S.key===b);if(!~h)return;if(g.key==="Enter")u(y[h]);else if(g.key==="ArrowDown")for(g.preventDefault(),h+=1;h<y.length;){if(!y[h].disabled){m.value=y[h].key;break}h+=1}else if(g.key==="ArrowUp")for(g.preventDefault(),h-=1;h>=0;){if(!y[h].disabled){m.value=y[h].key;break}h-=1}else if(g.key==="ArrowLeft"){const S=y[h];if(S.isLeaf||!t.value.includes(b)){const R=S.getParent();R&&(m.value=R.key)}else o(S)}else if(g.key==="ArrowRight"){const S=y[h];if(S.isLeaf)return;if(!t.value.includes(b))o(S);else for(h+=1;h<y.length;){if(!y[h].disabled){m.value=y[h].key;break}h+=1}}}}return{pendingNodeKeyRef:m,handleKeydown:K}}var Lt=me({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return v(Zn,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>v("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:ct(this.height)}},this.nodes.map(t=>v(En,{clsPrefix:e,tmNode:t})))})}}),Et=P("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[de("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),de(">",[P("tree-node",[de("&:first-child",{marginTop:0})])]),P("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 height: 0;
 `),P("tree-motion-wrapper",[$("expand",[bn({duration:"0.2s"})]),$("collapse",[bn({duration:"0.2s",reverse:!0})])]),P("tree-node-wrapper",`
 box-sizing: border-box;
 padding: 3px 0;
 `),P("tree-node",`
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[$("highlight",[P("tree-node-content",[ye("text",{borderBottomColor:"var(--n-node-text-color-disabled)"})])]),$("disabled",[P("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),_e("disabled",[$("clickable",[P("tree-node-content",`
 cursor: pointer;
 `)])])]),$("block-node",[P("tree-node-content",`
 flex-grow: 1;
 flex-shrink: 0;
 `)]),_e("block-line",[P("tree-node",[_e("disabled",[P("tree-node-content",[de("&:hover",{backgroundColor:"var(--n-node-color-hover)"})]),$("selectable",[P("tree-node-content",[de("&:active",{backgroundColor:"var(--n-node-color-pressed)"})])]),$("pending",[P("tree-node-content",`
 background-color: var(--n-node-color-hover);
 `)]),$("selected",[P("tree-node-content",{backgroundColor:"var(--n-node-color-active)"})])])])]),$("block-line",[P("tree-node",[_e("disabled",[de("&:hover",{backgroundColor:"var(--n-node-color-hover)"}),$("pending",`
 background-color: var(--n-node-color-hover);
 `),$("selectable",[_e("selected",[de("&:active",{backgroundColor:"var(--n-node-color-pressed)"})])]),$("selected",{backgroundColor:"var(--n-node-color-active)"})]),$("disabled",`
 cursor: not-allowed;
 `)])]),P("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: 24px;
 width: 24px;
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[ye("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[P("icon",[cn()]),P("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[cn()]),P("base-icon",[cn()])]),$("hide",{visibility:"hidden"}),$("expanded",{transform:"rotate(90deg)"})]),P("tree-node-checkbox",`
 display: inline-flex;
 height: 24px;
 width: 16px;
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 margin-right: 4px;
 `,[$("right","margin-left: 4px;")]),$("checkable",[P("tree-node-content",`
 padding: 0 6px;
 `)]),P("tree-node-content",`
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: 24px;
 box-sizing: border-box;
 line-height: 1.5;
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 text-decoration-color: #0000;
 text-decoration-line: underline;
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[de("&:last-child",{marginBottom:0}),ye("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),ye("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow:1;
 `),ye("suffix",`
 display: inline-flex;
 `)]),ye("empty","margin: auto;")]),Ot=globalThis&&globalThis.__awaiter||function(e,t,r,u){function o(f){return f instanceof r?f:new r(function(k){k(f)})}return new(r||(r=Promise))(function(f,k){function m(b){try{g(u.next(b))}catch(y){k(y)}}function K(b){try{g(u.throw(b))}catch(y){k(y)}}function g(b){b.done?f(b.value):o(b.value).then(m,K)}g((u=u.apply(e,t||[])).next())})};const Xe=30;function In(e,t){return{getKey(r){return r[e]},getChildren(r){return r[t]},getDisabled(r){return!!(r.disabled||r.checkboxDisabled)}}}const Bn={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array]},It=Object.assign(Object.assign(Object.assign(Object.assign({},Ye.props),{showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},indent:{type:Number,default:16},allowDrop:{type:Function,default:Tt},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),Bn),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean});var Bt=me({name:"Tree",props:It,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=Nn(e),u=Ye("Tree","-tree",Et,Kn,e,t),o=D(null),f=D(null),k=D(null);function m(){var n;return(n=k.value)===null||n===void 0?void 0:n.listElRef}function K(){var n;return(n=k.value)===null||n===void 0?void 0:n.itemsElRef}const g=T(()=>{const{pattern:n}=e;return n?!n.length||!Ne.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:Pt(e.data,Ne.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),b=T(()=>Fn(e.showIrrelevantNodes?e.data:g.value.filteredTree,In(e.keyField,e.childrenField))),y=Ee(hn,null),h=e.internalTreeSelect?y.dataTreeMate:b,{watchProps:S}=e,R=D([]);S!=null&&S.includes("defaultCheckedKeys")?Ue(()=>{R.value=e.defaultCheckedKeys}):R.value=e.defaultCheckedKeys;const _=A(e,"checkedKeys"),U=we(_,R),C=T(()=>h.value.getCheckedKeys(U.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),E=T(()=>e.leafOnly?"child":e.checkStrategy),O=T(()=>C.value.checkedKeys),j=T(()=>{const{indeterminateKeys:n}=e;return n!==void 0?n:C.value.indeterminateKeys}),V=D([]);S!=null&&S.includes("defaultSelectedKeys")?Ue(()=>{V.value=e.defaultSelectedKeys}):V.value=e.defaultSelectedKeys;const ae=A(e,"selectedKeys"),se=we(ae,V),J=D([]),re=n=>{J.value=e.defaultExpandAll?h.value.getNonLeafKeys():n===void 0?e.defaultExpandedKeys:n};S!=null&&S.includes("defaultExpandedKeys")?Ue(()=>re(void 0)):Ue(()=>re(e.defaultExpandedKeys));const Se=A(e,"expandedKeys"),i=we(Se,J),N=T(()=>b.value.getFlattenedNodes(i.value)),{pendingNodeKeyRef:L,handleKeydown:ce}=At({mergedSelectedKeysRef:se,fNodesRef:N,mergedExpandedKeysRef:i,handleSelect:x,handleSwitcherClick:d});let W=null,ue=null;const Oe=D(new Set),$e=T(()=>e.internalHighlightKeySet||g.value.highlightKeySet),Ge=we($e,Oe),Re=D(new Set),Je=T(()=>i.value.filter(n=>!Re.value.has(n)));let be=0;const fe=D(null),ke=D(null),Q=D(null),Ke=D(null),Ce=D(0),ze=T(()=>{const{value:n}=ke;return n?n.parent:null}),Ne=T(()=>{const{filter:n}=e;if(n)return n;const{labelField:a}=e;return(s,c)=>{if(!s.length)return!0;const p=c[a];return typeof p=="string"?p.toLowerCase().includes(s.toLowerCase()):!1}});We(A(e,"data"),()=>{Re.value.clear(),L.value=null,xe()},{deep:!1});let X;We(A(e,"pattern"),(n,a)=>{if(e.showIrrelevantNodes)if(X=void 0,n){const{expandedKeys:s,highlightKeySet:c}=Ft(e.data,e.pattern,e.keyField,e.childrenField,Ne.value);Oe.value=c,ge(s,G(s))}else Oe.value=new Set;else if(!n.length)X!==void 0&&ge(X,G(X));else{a.length||(X=i.value);const{expandedKeys:s}=g.value;s!==void 0&&ge(s,G(s))}});function Te(n){return Ot(this,void 0,void 0,function*(){const{onLoad:a}=e;if(!a)return yield Promise.resolve();const{value:s}=Re;return yield new Promise(c=>{s.has(n.key)||(s.add(n.key),a(n.rawNode).then(()=>{s.delete(n.key),c()}).catch(p=>{console.error(p),ve()}))})})}Ue(()=>{var n;const{value:a}=b;if(!a)return;const{getNode:s}=a;(n=i.value)===null||n===void 0||n.forEach(c=>{const p=s(c);p&&!p.shallowLoaded&&Te(p)})});const he=D(!1),Z=D([]);We(Je,(n,a)=>{if(!e.animated){kn(Fe);return}const s=new Set(a);let c=null,p=null;for(const z of n)if(!s.has(z)){if(c!==null)return;c=z}const ne=new Set(n);for(const z of a)if(!ne.has(z)){if(p!==null)return;p=z}if(c!==null&&p!==null||c===null&&p===null)return;const{virtualScroll:H}=e,Be=(H?k.value.listElRef:o.value).offsetHeight,pe=Math.ceil(Be/Xe)+1;if(c!==null){he.value=!0,Z.value=b.value.getFlattenedNodes(a);const z=Z.value.findIndex(q=>q.key===c);if(~z){const q=xn(Z.value[z].children,n);Z.value.splice(z+1,0,{__motion:!0,mode:"expand",height:H?q.length*Xe:void 0,nodes:H?q.slice(0,pe):q})}}if(p!==null){Z.value=b.value.getFlattenedNodes(n);const z=Z.value.findIndex(q=>q.key===p);if(~z){const q=Z.value[z].children;if(!q)return;he.value=!0;const te=xn(q,n);Z.value.splice(z+1,0,{__motion:!0,mode:"collapse",height:H?te.length*Xe:void 0,nodes:H?te.slice(0,pe):te})}}});const Qe=T(()=>at(N.value)),De=T(()=>he.value?Z.value:N.value);function Fe(){const{value:n}=f;n&&n.sync()}function Ze(){he.value=!1,e.virtualScroll&&kn(Fe)}function G(n){const{getNode:a}=h.value;return n.map(s=>{var c;return((c=a(s))===null||c===void 0?void 0:c.rawNode)||null})}function ge(n,a){const{"onUpdate:expandedKeys":s,onUpdateExpandedKeys:c}=e;J.value=n,s&&B(s,n,a),c&&B(c,n,a)}function je(n,a){const{"onUpdate:checkedKeys":s,onUpdateCheckedKeys:c}=e;R.value=n,c&&B(c,n,a),s&&B(s,n,a)}function en(n,a){const{"onUpdate:indeterminateKeys":s,onUpdateIndeterminateKeys:c}=e;s&&B(s,n,a),c&&B(c,n,a)}function Ie(n,a){const{"onUpdate:selectedKeys":s,onUpdateSelectedKeys:c}=e;V.value=n,c&&B(c,n,a),s&&B(s,n,a)}function nn(n){const{onDragenter:a}=e;a&&B(a,n)}function tn(n){const{onDragleave:a}=e;a&&B(a,n)}function Ve(n){const{onDragend:a}=e;a&&B(a,n)}function ln(n){const{onDragstart:a}=e;a&&B(a,n)}function an(n){const{onDragover:a}=e;a&&B(a,n)}function rn(n){const{onDrop:a}=e;a&&B(a,n)}function xe(){He(),ee()}function He(){fe.value=null}function ee(){Ce.value=0,ke.value=null,Q.value=null,Ke.value=null,ve()}function ve(){W&&(window.clearTimeout(W),W=null),ue=null}function oe(n,a){if(e.disabled||n.disabled)return;if(e.internalUnifySelectCheck&&!e.multiple){x(n);return}const{checkedKeys:s,indeterminateKeys:c}=h.value[a?"check":"uncheck"](n.key,O.value,{cascade:e.cascade,checkStrategy:E.value,allowNotLoaded:e.allowCheckingNotLoaded});je(s,G(s)),en(c,G(c))}function l(n){if(e.disabled)return;const{value:a}=i,s=a.findIndex(c=>c===n);if(~s){const c=Array.from(a);c.splice(s,1),ge(c,G(c))}else{const c=b.value.getNode(n);if(!c||c.isLeaf)return;const p=a.concat(n);ge(p,G(p))}}function d(n){e.disabled||he.value||l(n.key)}function x(n){if(!(e.disabled||!e.selectable)){if(L.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:a,indeterminateKeys:s}}=C;e.multiple?oe(n,!(a.includes(n.key)||s.includes(n.key))):je([n.key],G([n.key]))}if(e.multiple){const a=Array.from(se.value),s=a.findIndex(c=>c===n.key);~s?e.cancelable&&a.splice(s,1):~s||a.push(n.key),Ie(a,G(a))}else se.value.includes(n.key)?e.cancelable&&Ie([],[]):Ie([n.key],G([n.key]))}}function w(n){if(W&&(window.clearTimeout(W),W=null),n.isLeaf)return;ue=n.key;const a=()=>{if(ue!==n.key)return;const{value:s}=Q;if(s&&s.key===n.key&&!i.value.includes(n.key)){const c=i.value.concat(n.key);ge(c,G(c))}W=null,ue=null};n.shallowLoaded?W=window.setTimeout(()=>{a()},1e3):W=window.setTimeout(()=>{Te(n).then(()=>{a()})},1e3)}function M({event:n,node:a}){!e.draggable||e.disabled||a.disabled||(Ae({event:n,node:a},!1),nn({event:n,node:a.rawNode}))}function I({event:n,node:a}){!e.draggable||e.disabled||a.disabled||tn({event:n,node:a.rawNode})}function ie(n){n.target===n.currentTarget&&ee()}function Pe({event:n,node:a}){xe(),!(!e.draggable||e.disabled||a.disabled)&&Ve({event:n,node:a.rawNode})}function qe({event:n,node:a}){!e.draggable||e.disabled||a.disabled||(be=n.clientX,fe.value=a,ln({event:n,node:a.rawNode}))}function Ae({event:n,node:a},s=!0){var c;if(!e.draggable||e.disabled||a.disabled)return;const{value:p}=fe;if(!p)return;const{allowDrop:ne,indent:H}=e;s&&an({event:n,node:a.rawNode});const Be=n.currentTarget,{height:pe,top:z}=Be.getBoundingClientRect(),q=n.clientY-z;let te;ne({node:a.rawNode,dropPosition:"inside",phase:"drag"})?q<=8?te="before":q>=pe-8?te="after":te="inside":q<=pe/2?te="before":te="after";const{value:jn}=Qe;let F,Y;const on=jn(a.key);if(on===null){ee();return}let vn=!1;te==="inside"?(F=a,Y="inside"):te==="before"?a.isFirstChild?(F=a,Y="before"):(F=N.value[on-1],Y="after"):(F=a,Y="after"),!F.isLeaf&&i.value.includes(F.key)&&(vn=!0,Y==="after"&&(F=N.value[on+1],F?Y="before":(F=a,Y="inside")));const yn=F;if(Q.value=yn,!vn&&p.isLastChild&&p.key===F.key&&(Y="after"),Y==="after"){let mn=be-n.clientX,dn=0;for(;mn>=H/2&&F.parent!==null&&F.isLastChild&&dn<1;)mn-=H,dn+=1,F=F.parent;Ce.value=dn}else Ce.value=0;if((p.contains(F)||Y==="inside"&&((c=p.parent)===null||c===void 0?void 0:c.key)===F.key)&&!(p.key===yn.key&&p.key===F.key)){ee();return}if(!ne({node:F.rawNode,dropPosition:Y,phase:"drag"})){ee();return}if(p.key===F.key)ve();else if(ue!==F.key)if(Y==="inside"){if(e.expandOnDragenter){if(w(F),!F.shallowLoaded&&ue!==F.key){xe();return}}else if(!F.shallowLoaded){xe();return}}else ve();else Y!=="inside"&&ve();Ke.value=Y,ke.value=F}function _n({event:n,node:a,dropPosition:s}){if(!e.draggable||e.disabled||a.disabled)return;const{value:c}=fe,{value:p}=ke,{value:ne}=Ke;if(!(!c||!p||!ne)&&!!e.allowDrop({node:p.rawNode,dropPosition:ne,phase:"drag"})&&c.key!==p.key){if(ne==="before"){const H=c.getNext({includeDisabled:!0});if(H&&H.key===p.key){ee();return}}if(ne==="after"){const H=c.getPrev({includeDisabled:!0});if(H&&H.key===p.key){ee();return}}rn({event:n,node:p.rawNode,dragNode:c.rawNode,dropPosition:s}),xe()}}function Un(){Fe()}function Mn(){Fe()}function $n(n){var a;if(e.virtualScroll||e.internalScrollable){const{value:s}=f;if(!((a=s==null?void 0:s.containerRef)===null||a===void 0)&&a.contains(n.relatedTarget))return;L.value=null}else{const{value:s}=o;if(s!=null&&s.contains(n.relatedTarget))return;L.value=null}}We(L,n=>{var a,s;if(n!==null){if(e.virtualScroll)(a=k.value)===null||a===void 0||a.scrollTo({key:n});else if(e.internalScrollable){const{value:c}=f;if(c===null)return;const p=(s=c.contentRef)===null||s===void 0?void 0:s.querySelector(`[data-key="${Ln(n)}"]`);if(!p)return;c.scrollTo({el:p})}}}),Tn(Me,{loadingKeysRef:Re,highlightKeySetRef:Ge,displayedCheckedKeysRef:O,displayedIndeterminateKeysRef:j,mergedSelectedKeysRef:se,mergedExpandedKeysRef:i,mergedThemeRef:u,mergedCheckStrategyRef:E,nodePropsRef:A(e,"nodeProps"),disabledRef:A(e,"disabled"),checkableRef:A(e,"checkable"),selectableRef:A(e,"selectable"),expandOnClickRef:A(e,"expandOnClick"),onLoadRef:A(e,"onLoad"),draggableRef:A(e,"draggable"),blockLineRef:A(e,"blockLine"),indentRef:A(e,"indent"),cascadeRef:A(e,"cascade"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Q,droppingNodeParentRef:ze,draggingNodeRef:fe,droppingPositionRef:Ke,droppingOffsetLevelRef:Ce,fNodesRef:N,pendingNodeKeyRef:L,internalScrollableRef:A(e,"internalScrollable"),internalCheckboxFocusableRef:A(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:A(e,"renderLabel"),renderPrefixRef:A(e,"renderPrefix"),renderSuffixRef:A(e,"renderSuffix"),renderSwitcherIconRef:A(e,"renderSwitcherIcon"),labelFieldRef:A(e,"labelField"),multipleRef:A(e,"multiple"),handleSwitcherClick:d,handleDragEnd:Pe,handleDragEnter:M,handleDragLeave:I,handleDragStart:qe,handleDrop:_n,handleDragOver:Ae,handleSelect:x,handleCheck:oe});const zn={handleKeydown:ce},gn=T(()=>{const{common:{cubicBezierEaseInOut:n},self:{fontSize:a,nodeBorderRadius:s,nodeColorHover:c,nodeColorPressed:p,nodeColorActive:ne,arrowColor:H,loadingColor:Be,nodeTextColor:pe,nodeTextColorDisabled:z,dropMarkColor:q}}=u.value;return{"--n-arrow-color":H,"--n-loading-color":Be,"--n-bezier":n,"--n-font-size":a,"--n-node-border-radius":s,"--n-node-color-active":ne,"--n-node-color-hover":c,"--n-node-color-pressed":p,"--n-node-text-color":pe,"--n-node-text-color-disabled":z,"--n-drop-mark-color":q}}),Le=r?Dn("tree",void 0,gn,e):void 0;return{mergedClsPrefix:t,mergedTheme:u,fNodes:De,aip:he,selfElRef:o,virtualListInstRef:k,scrollbarInstRef:f,handleFocusout:$n,handleDragLeaveTree:ie,handleScroll:Un,getScrollContainer:m,getScrollContent:K,handleAfterEnter:Ze,handleResize:Mn,handleKeydown:zn.handleKeydown,cssVars:r?void 0:gn,themeClass:Le==null?void 0:Le.themeClass,onRender:Le==null?void 0:Le.onRender}},render(){var e;const{fNodes:t,internalRenderEmpty:r}=this;if(!t.length&&r)return r();const{mergedClsPrefix:u,blockNode:o,blockLine:f,draggable:k,disabled:m,internalFocusable:K,checkable:g,handleKeydown:b,handleFocusout:y}=this,h=K&&!m,S=h?"0":void 0,R=[`${u}-tree`,g&&`${u}-tree--checkable`,(f||o)&&`${u}-tree--block-node`,f&&`${u}-tree--block-line`],_=C=>"__motion"in C?v(Lt,{height:C.height,nodes:C.nodes,clsPrefix:u,mode:C.mode,onAfterEnter:this.handleAfterEnter}):v(En,{key:C.key,tmNode:C,clsPrefix:u});if(this.virtualScroll){const{mergedTheme:C,internalScrollablePadding:E}=this,O=ut(E||"0");return v(pn,{ref:"scrollbarInstRef",onDragleave:k?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:R,theme:C.peers.Scrollbar,themeOverrides:C.peerOverrides.Scrollbar,tabindex:S,onKeydown:h?b:void 0,onFocusout:h?y:void 0},{default:()=>{var j;return(j=this.onRender)===null||j===void 0||j.call(this),v(rt,{ref:"virtualListInstRef",items:this.fNodes,itemSize:Xe,ignoreItemResize:this.aip,paddingTop:O.top,paddingBottom:O.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:O.left,paddingRight:O.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:V})=>_(V)})}})}const{internalScrollable:U}=this;return R.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),U?v(pn,{class:R,tabindex:S,onKeydown:h?b:void 0,onFocusout:h?y:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}},{default:()=>v("div",{onDragleave:k?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(_))}):v("div",{class:R,tabindex:S,ref:"selfElRef",style:this.cssVars,onKeydown:h?b:void 0,onFocusout:h?y:void 0,onDragleave:k?this.handleDragLeaveTree:void 0},t.length?t.map(_):An(this.$slots.empty,()=>{var C,E,O,j;return[v(Pn,{class:`${u}-tree__empty`,theme:(E=(C=this.theme)===null||C===void 0?void 0:C.peers)===null||E===void 0?void 0:E.Empty,themeOverrides:(j=(O=this.themeOverrides)===null||O===void 0?void 0:O.peers)===null||j===void 0?void 0:j.Empty})]}))}});function Sn(e,t){const{rawNode:r}=e;return Object.assign(Object.assign({},r),{label:r[t],value:e.key})}function Rn(e,t,r,u){const{rawNode:o}=e;return Object.assign(Object.assign({},o),{value:e.key,label:t.map(f=>f.rawNode[u]).join(r)})}var _t=de([P("tree-select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),P("tree-select-menu",`
 position: relative;
 overflow: hidden;
 margin: 4px 0;
 transition: box-shadow .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-menu-border-radius);
 box-shadow: var(--n-menu-box-shadow);
 background-color: var(--n-menu-color);
 outline: none;
 `,[P("tree","max-height: var(--n-menu-height);"),ye("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),ye("action",`
 padding: var(--n-action-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),ht()])]);const Ut=Object.assign(Object.assign(Object.assign(Object.assign({},Ye.props),{bordered:{type:Boolean,default:!0},cascade:Boolean,checkable:Boolean,clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},consistentMenuWidth:{type:Boolean,default:!0},defaultShow:Boolean,defaultValue:{type:[String,Number,Array],default:null},disabled:{type:Boolean,default:void 0},filterable:Boolean,checkStrategy:{type:String,default:"all"},loading:Boolean,maxTagCount:[String,Number],multiple:Boolean,showPath:Boolean,separator:{type:String,default:" / "},options:{type:Array,default:()=>[]},placeholder:String,placement:{type:String,default:"bottom-start"},show:{type:Boolean,default:void 0},size:String,value:[String,Number,Array],to:fn.propTo,menuProps:Object,virtualScroll:{type:Boolean,default:!0},status:String,renderTag:Function}),Bn),{renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,onBlur:Function,onFocus:Function,onLoad:Function,onUpdateShow:[Function,Array],onUpdateValue:[Function,Array],"onUpdate:value":[Function,Array],"onUpdate:show":[Function,Array],leafOnly:Boolean});var Zt=me({name:"TreeSelect",props:Ut,setup(e){const t=D(null),r=D(null),u=D(null),o=D(null),{mergedClsPrefixRef:f,namespaceRef:k,inlineThemeDisabled:m}=Nn(e),{localeRef:K}=vt("Select"),{mergedSizeRef:g,mergedDisabledRef:b,mergedStatusRef:y,nTriggerFormBlur:h,nTriggerFormChange:S,nTriggerFormFocus:R,nTriggerFormInput:_}=yt(e),U=D(e.defaultValue),C=A(e,"value"),E=we(C,U),O=D(e.defaultShow),j=A(e,"show"),V=we(j,O),ae=D(""),se=T(()=>{const{filter:l}=e;if(l)return l;const{labelField:d}=e;return(x,w)=>x.length?w[d].toLowerCase().includes(x.toLowerCase()):!0}),J=T(()=>Fn(e.options,In(e.keyField,e.childrenField))),{value:re}=E,Se=D(e.checkable?null:Array.isArray(re)&&re.length?re[re.length-1]:null),i=T(()=>e.multiple&&e.cascade&&e.checkable),N=D(e.defaultExpandAll?void 0:e.defaultExpandedKeys||e.expandedKeys),L=A(e,"expandedKeys"),ce=we(L,N),W=D(!1),ue=T(()=>{const{placeholder:l}=e;return l!==void 0?l:K.value.placeholder}),Oe=T(()=>e.checkable?[]:$e.value),$e=T(()=>{const{value:l}=E;return e.multiple?Array.isArray(l)?l:[]:l===null||Array.isArray(l)?[]:[l]}),Ge=T(()=>{const{multiple:l,showPath:d,separator:x,labelField:w}=e;if(l)return null;const{value:M}=E;if(!Array.isArray(M)&&M!==null){const{value:I}=J,ie=I.getNode(M);if(ie!==null)return d?Rn(ie,I.getPath(M).treeNodePath,x,w):Sn(ie,w)}return null}),Re=T(()=>{const{multiple:l,showPath:d,separator:x}=e;if(!l)return null;const{value:w}=E;if(Array.isArray(w)){const M=[],{value:I}=J,{checkedKeys:ie}=I.getCheckedKeys(w,{checkStrategy:e.checkStrategy,cascade:i.value,allowNotLoaded:e.allowCheckingNotLoaded}),{labelField:Pe}=e;return ie.forEach(qe=>{const Ae=I.getNode(qe);Ae!==null&&M.push(d?Rn(Ae,I.getPath(qe).treeNodePath,x,Pe):Sn(Ae,Pe))}),M}return[]}),Je=T(()=>{const{self:{menuPadding:l}}=ee.value;return l});function be(){var l;(l=r.value)===null||l===void 0||l.focus()}function fe(){var l;(l=r.value)===null||l===void 0||l.focusInput()}function ke(l){const{onUpdateShow:d,"onUpdate:show":x}=e;d&&B(d,l),x&&B(x,l),O.value=l}function Q(l,d){const{onUpdateValue:x,"onUpdate:value":w}=e;x&&B(x,l,d),w&&B(w,l,d),U.value=l,_(),S()}function Ke(l,d){const{onUpdateIndeterminateKeys:x,"onUpdate:indeterminateKeys":w}=e;x&&B(x,l,d),w&&B(w,l,d)}function Ce(l,d){const{onUpdateExpandedKeys:x,"onUpdate:expandedKeys":w}=e;x&&B(x,l,d),w&&B(w,l,d),N.value=l}function ze(l){const{onFocus:d}=e;d&&d(l),R()}function Ne(l){X();const{onBlur:d}=e;d&&d(l),h()}function X(){ke(!1)}function Te(){b.value||(ae.value="",ke(!0),e.filterable&&fe())}function he(){ae.value=""}function Z(l){var d;V.value&&(!((d=r.value)===null||d===void 0)&&d.$el.contains(l.target)||X())}function Qe(){b.value||(V.value?e.filterable||X():Te())}function De(l){const{value:{getNode:d}}=J;return l.map(x=>{var w;return((w=d(x))===null||w===void 0?void 0:w.rawNode)||null})}function Fe(l){const d=De(l);e.multiple?Q(l,d):(l.length?Q(l[0],d[0]||null):Q(null,null),X(),e.filterable||be()),e.filterable&&(fe(),e.clearFilterAfterSelect&&(ae.value=""))}function Ze(l){e.checkable&&Ke(l,De(l))}function G(l){var d;!((d=o.value)===null||d===void 0)&&d.contains(l.relatedTarget)||(W.value=!0,ze(l))}function ge(l){var d;!((d=o.value)===null||d===void 0)&&d.contains(l.relatedTarget)||(W.value=!1,Ne(l))}function je(l){var d,x,w;((d=o.value)===null||d===void 0?void 0:d.contains(l.relatedTarget))||((w=(x=r.value)===null||x===void 0?void 0:x.$el)===null||w===void 0?void 0:w.contains(l.relatedTarget))||(W.value=!0,ze(l))}function en(l){var d,x,w;((d=o.value)===null||d===void 0?void 0:d.contains(l.relatedTarget))||((w=(x=r.value)===null||x===void 0?void 0:x.$el)===null||w===void 0?void 0:w.contains(l.relatedTarget))||(W.value=!1,Ne(l))}function Ie(l){l.stopPropagation();const{multiple:d}=e;!d&&e.filterable&&X(),d?Q([],[]):Q(null,null)}function nn(l){const{value:d}=E;if(Array.isArray(d)){const{value:x}=J,{checkedKeys:w}=x.getCheckedKeys(d,{cascade:i.value,allowNotLoaded:e.allowCheckingNotLoaded}),M=w.findIndex(I=>I===l.value);if(~M)if(e.checkable){const{checkedKeys:I}=x.uncheck(l.value,w,{checkStrategy:e.checkStrategy,cascade:i.value,allowNotLoaded:e.allowCheckingNotLoaded});Q(I,De(I))}else{const I=Array.from(w);I.splice(M,1),Q(I,De(I))}}}function tn(l){const{value:d}=l.target;ae.value=d}function Ve(l){const{value:d}=u;d&&d.handleKeydown(l)}function ln(l){l.key==="Enter"?(V.value?(Ve(l),e.multiple||(X(),be())):Te(),l.preventDefault()):l.key==="Escape"?V.value&&(gt(l),X(),be()):V.value?Ve(l):l.key==="ArrowDown"&&Te()}function an(){X(),be()}function rn(l){un(l,"action")||l.preventDefault()}const xe=T(()=>{const{renderTag:l}=e;if(!!l)return function({option:x,handleClose:w}){const{value:M}=x;if(M!==void 0){const I=J.value.getNode(M);if(I)return l({option:I.rawNode,handleClose:w})}return M}});Tn(hn,{pendingNodeKeyRef:Se,dataTreeMate:J});function He(){var l;!V.value||(l=t.value)===null||l===void 0||l.syncPosition()}ot(o,He);const ee=Ye("TreeSelect","-tree-select",_t,Rt,e,f),ve=T(()=>{const{common:{cubicBezierEaseInOut:l},self:{menuBoxShadow:d,menuBorderRadius:x,menuColor:w,menuHeight:M,actionPadding:I,actionDividerColor:ie,actionTextColor:Pe}}=ee.value;return{"--n-menu-box-shadow":d,"--n-menu-border-radius":x,"--n-menu-color":w,"--n-menu-height":M,"--n-bezier":l,"--n-action-padding":I,"--n-action-text-color":Pe,"--n-action-divider-color":ie}}),oe=m?Dn("tree-select",void 0,ve,e):void 0;return{menuElRef:o,mergedStatus:y,triggerInstRef:r,followerInstRef:t,treeInstRef:u,mergedClsPrefix:f,mergedValue:E,mergedShow:V,namespace:k,adjustedTo:fn(e),isMounted:et(),focused:W,menuPadding:Je,mergedPlaceholder:ue,mergedExpandedKeys:ce,treeSelectedKeys:Oe,treeCheckedKeys:$e,mergedSize:g,mergedDisabled:b,selectedOption:Ge,selectedOptions:Re,pattern:ae,pendingNodeKey:Se,mergedCascade:i,mergedFilter:se,selectionRenderTag:xe,handleTriggerOrMenuResize:He,doUpdateExpandedKeys:Ce,handleMenuLeave:he,handleTriggerClick:Qe,handleMenuClickoutside:Z,handleUpdateCheckedKeys:Fe,handleUpdateIndeterminateKeys:Ze,handleTriggerFocus:G,handleTriggerBlur:ge,handleMenuFocusin:je,handleMenuFocusout:en,handleClear:Ie,handleDeleteOption:nn,handlePatternInput:tn,handleKeydown:ln,handleTabOut:an,handleMenuMousedown:rn,mergedTheme:ee,cssVars:m?void 0:ve,themeClass:oe==null?void 0:oe.themeClass,onRender:oe==null?void 0:oe.onRender}},render(){const{mergedTheme:e,mergedClsPrefix:t,$slots:r}=this;return v("div",{class:`${t}-tree-select`},v(bt,null,{default:()=>[v(kt,null,{default:()=>v(it,{ref:"triggerInstRef",onResize:this.handleTriggerOrMenuResize,status:this.mergedStatus,focused:this.focused,clsPrefix:t,theme:e.peers.InternalSelection,themeOverrides:e.peerOverrides.InternalSelection,renderTag:this.selectionRenderTag,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,size:this.mergedSize,bordered:this.bordered,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,active:this.mergedShow,loading:this.loading,multiple:this.multiple,maxTagCount:this.maxTagCount,showArrow:!0,filterable:this.filterable,clearable:this.clearable,pattern:this.pattern,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onDeleteOption:this.handleDeleteOption,onKeydown:this.handleKeydown},{arrow:()=>{var u,o;return[(o=(u=this.$slots).arrow)===null||o===void 0?void 0:o.call(u)]}})}),v(xt,{ref:"followerInstRef",show:this.mergedShow,placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===fn.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target"},{default:()=>v(nt,{name:"fade-in-scale-up-transition",appear:this.isMounted,onLeave:this.handleMenuLeave},{default:()=>{var u;if(!this.mergedShow)return null;const{mergedClsPrefix:o,checkable:f,multiple:k,menuProps:m,options:K}=this;return(u=this.onRender)===null||u===void 0||u.call(this),tt(v("div",Object.assign({},m,{class:[`${o}-tree-select-menu`,m==null?void 0:m.class,this.themeClass],ref:"menuElRef",style:[(m==null?void 0:m.style)||"",this.cssVars],tabindex:0,onMousedown:this.handleMenuMousedown,onKeydown:this.handleKeydown,onFocusin:this.handleMenuFocusin,onFocusout:this.handleMenuFocusout}),v(Bt,{ref:"treeInstRef",blockLine:!0,allowCheckingNotLoaded:this.allowCheckingNotLoaded,showIrrelevantNodes:!1,animated:!1,pattern:this.pattern,filter:this.mergedFilter,data:K,cancelable:k,labelField:this.labelField,keyField:this.keyField,childrenField:this.childrenField,theme:e.peers.Tree,themeOverrides:e.peerOverrides.Tree,defaultExpandAll:this.defaultExpandAll,defaultExpandedKeys:this.defaultExpandedKeys,expandedKeys:this.mergedExpandedKeys,checkedKeys:this.treeCheckedKeys,selectedKeys:this.treeSelectedKeys,checkable:f,checkStrategy:this.checkStrategy,cascade:this.mergedCascade,leafOnly:this.leafOnly,multiple:this.multiple,renderLabel:this.renderLabel,renderPrefix:this.renderPrefix,renderSuffix:this.renderSuffix,renderSwitcherIcon:this.renderSwitcherIcon,nodeProps:this.nodeProps,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,internalTreeSelect:!0,internalUnifySelectCheck:!0,internalScrollable:!0,internalScrollablePadding:this.menuPadding,internalFocusable:!1,internalCheckboxFocusable:!1,internalRenderEmpty:()=>v("div",{class:`${o}-tree-select-menu__empty`},An(r.empty,()=>[v(Pn,{theme:e.peers.Empty,themeOverrides:e.peerOverrides.Empty})])),onLoad:this.onLoad,onUpdateCheckedKeys:this.handleUpdateCheckedKeys,onUpdateIndeterminateKeys:this.handleUpdateIndeterminateKeys,onUpdateExpandedKeys:this.doUpdateExpandedKeys}),ft(r.action,g=>g?v("div",{class:`${o}-tree-select-menu__action`,"data-action":!0},g):null),v(dt,{onFocus:this.handleTabOut})),[[mt,this.handleMenuClickoutside,void 0,{capture:!0}]])}})})]}))}});export{Zt as N};
